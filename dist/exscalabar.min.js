!function(){angular.module("main",["ngRoute","ui.bootstrap","ui.bootstrap.contextMenu","dygraph","cirrus.ui.ibutton","cirrus.ui.inumeric","cirrus.ui.string","ngSanitize","ui.bootstrap.dropdownToggle"])}(),function(){angular.module("main").factory("net",function(){return localStorage.ip||(localStorage.ip="192.168.0.73"),localStorage.port||(localStorage.port="8001"),{ip:localStorage.ip,port:localStorage.port,getNetworkParams:function(){return{ip:this.ip,port:this._port}},setNetworkParams:function(t,a){this._ip=t,this.port=a,localStorage.ip=t,localStorage.port=a},setIP:function(t){this.ip=t,localStorage.ip=t},setPort:function(t){this.port=t,localStorage.port=t},address:function(){return"http://"+this.ip+":"+this.port+"/xService/"}}})}(),function(){function t(t,a){var e=t,n=a;this.net=n,this.fred=1e3,this.dcred=50,this.fblue=2e3,this.dcblue=50,this.kred=1,this.kblue=1,this.kpmt=[0,0,0,0,0],this.eblue=!0,this.ered=!0,this.setLaserRate=function(t,a){var i="CRDS_CMD/fblue?Rate="+a;t?(i="CRDS_CMD/fred?Rate="+a,this.fred=a):this.fblue=a,e.get(n.address()+i)},this.setEnable=function(t){this.eblue=t[0],this.ered=t[1];var a=this.ered?1:0,i=this.eblue?1:0,o="CRDS_CMD/LaserEnable?Red="+a+"&Blue="+i;e.get(n.address()+o)},this.setGain=function(t){this.kpmt=t,e.get(n.address()+"CRDS_CMD/Vpmt?V="+t.toString())},this.setLaserGain=function(t){this.kred=t[1],this.kblue=t[0],e.get(n.address()+"CRDS_CMD/LaserGain?B1=0&B0="+t[0]+"&R="+t[1])}}function a(t,a){var e=t,n=a;this.spk={vrange:5,voffset:0,f0:1350,df:100,pos:!0,auto:!1,period:360,length:30},this.las={vr:[5,5,5,5,5],voffset:[1,2,3,4,5],f0:[1351,1352,1353,1354,1355],modulation:[!1,!1,!1,!1,!1],enable:[!1,!1,!1,!1,!1]},this.las.setf0=function(t){this.f0=t,e.get(n.address()+"PAS_CMD/UpdateFr?f0="+t.join(","))},this.las.setVr=function(t){this.las.vr=t,e.get(n.address()+"PAS_CMD/UpdateVrange?Vrange="+t.join(","))},this.las.setVo=function(t){this.las.vr=vr,e.get(n.address()+"PAS_CMD/UpdateVoffset?Voffset="+t.join(","))},this.las.updateMod=function(t){this.moduldation=t;var a=[];for(i=0;i<t.length;i++)a.push(t?1:0)},this.las.updateEnable=function(t){this.enable=t},this.spk.updateCtl=function(t){var a=t.pos?1:0;e.get(n.address()+"PAS_CMD/SpkSw?SpkSw="+a),e.get(n.address()+"PAS_CMD/Spk?df="+this.df+"&f0="+this.f0),e.get(n.address()+"PAS_CMD/UpdateSpkVparams?Voffset="+this.voffset+"&Vrange="+this.vrange)},this.spk.updateCycle=function(t,a,i){this.auto=t,this.length=i,this.period=a;var o=t?1:0;e.get(n.address()+"PAS_CMD/UpdateSpkCycle?Length="+i+"&Period="+a+"&Cycle="+o)}}function e(t){for(var a in t)if(t.hasOwnProperty(a))return!1;return!0}angular.module("main").factory("cvt",["$http","net","$rootScope",function(n,i,o){function s(t,a,e,n,i,o){this.p=t,this.i=a,this.d=e,this.sp=n,this.en=i,this.updateEn=function(){},this.updateParams=function(t){},this.name=o}var l={save:!0,ozone:!1,filter_pos:!0,first_call:1,fctl:[],power:{Pump:!1,O3Gen:!1,Denuder:!1,Laser:!1,TEC:!1},purge:{setSw:function(t){this.pos=t;var a=t?1:0;n.get(i.address()+"General/PurgeSwitch?val="+a)},pos:!0}};return l.humidifier=[new s(.75,1,0,90,!1,"Medium"),new s(.75,1,0,80,!1,"High")],l.pas=new a(n,i),l.crd=new t(n,i),l.filter={cycle:{period:360,length:20,auto:!1},position:!0,updateCycle:function(t){this.cycle=t;var a=this.cycle.auto?1:0;n.get(i.address()+"General/FilterCycle?Length="+this.cycle.length+"&Period="+this.cycle.period+"&auto="+a)},updatePos:function(t){this.position=t;var a=this.position?1:0;n.get(i.address()+"General/UpdateFilter?State="+a)}},l.checkCvt=function(){promise=n.get(i.address()+"General/cvt?force="+l.first_call).then(function(t){if(first_Call=0,!e(t.data)){var a=t.data.crd,n=t.data.pas,i=t.data.humidifier;l.humidifier[0].p=i.med.p,l.humidifier[0].i=i.med.i,l.humidifier[0].d=i.med.d,l.humidifier[0].en=i.med.ctl,l.humidifier[0].sp=i.med.rhsp,l.humidifier[1].p=i.high.p,l.humidifier[1].i=i.high.i,l.humidifier[1].d=i.high.d,l.humidifier[1].en=i.high.ctl,l.humidifier[1].sp=i.high.rhsp,l.crd.fred=a.red.f,l.crd.fblue=a.blue.f,l.crd.dcred=a.red.dc,l.crd.dcblue=a.blue.dc,l.crd.kpmt=a.kpmt,l.pas.las.f0=n.las.f0,l.pas.las.vrange=n.las.vrange,l.pas.las.voffset=n.las.voffset,l.pas.las.enable=n.las.enabled,l.pas.spk.f0=n.spk.fcenter,l.pas.spk.df=n.spk.df,l.pas.spk.vrange=n.spk.vrange,l.pas.spk.voffset=n.spk.voffset,l.pas.spk.auto=n.spk.cycle,l.pas.spk.length=n.spk.length,l.pas.spk.period=n.spk.period,l.pas.spk.pos=n.spk.enabled,l.filter.cycle.period=t.data.filter.period,l.filter.cycle.length=t.data.filter.length,l.filter.cycle.auto=t.data.filter.auto,l.filter.position=t.data.general.filter_pos;for(var s=Number(t.data.general.power).toString(2);s.length<5;)s+="0";l.power.Pump="1"==s[4],l.power.O3Gen="1"==s[3],l.power.Denuder="1"==s[2],l.power.Laser="1"==s[1],l.power.TEC="1"==s[0],o.$broadcast("cvtUpdated")}})},l.flows={},l.flows.updateSP=function(t,a){l.flows[t]=a,n.get(i.address()+"General/DevSP?SP="+a+"&DevID="+t)},l.updatePS=function(t){n.get(i.address()+"General/PowerSupply?val="+t)},l}])}(),function(){angular.module("main").config(["$routeProvider",function(t){t.when("/CRDS",{templateUrl:"crd/crds.html"}).when("/PAS",{templateUrl:"pas/pas.html"}).when("/O3",{templateUrl:"o3/ozone.html"}).when("/",{templateUrl:"main/main.html"}).when("/Flows",{templateUrl:"alicat/flows.html"}).when("/Temperature",{templateUrl:"views/temperature.html"}).when("/Humidifier",{templateUrl:"humidity/humidifier.html"}).when("/Common",{templateUrl:"views/common.html"}).when("/Config",{templateUrl:"config/config.html"}).when("/msg",{templateUrl:"msgs/msg.html"})}])}(),function(){function t(t,a,e){{var n={name:"",version:"",pas:{colors:[],xGrid:!1,yGrid:!1},crd:{colors:[],xGrid:!1,yGrid:!1},flow:{colors:[],xGrid:!1,yGrid:!1}},i=a.$$absUrl.search("#/"),o=a.$$absUrl.slice(0,i)+"ui.json";t.get(o).then(function(t){n.name=t.data.name,n.version=t.data.version,n.pas.xGrid=t.data.pasplot.xGrid,n.pas.yGrid=t.data.pasplot.yGrid,n.pas.xGrid=t.data.crdplot.xGrid,n.pas.yGrid=t.data.crdplot.yGrid,n.flow.xGrid=t.data.flowplot.xGrid,n.flow.yGrid=t.data.flowplot.yGrid,e.$broadcast("CfgUpdated")},function(){console.log("Configuration file not found."),n.name="EXSCALABAR",n.version="0.1.0"})["finally"](function(){})}return n}angular.module("main").factory("ExReadCfgSvc",t),t.$inject=["$http","$location","$rootScope"]}(),function(){angular.module("main").controller("MainCtlr",["Data","$scope","$rootScope","$interval","cvt","ExReadCfgSvc",function(t,a,e,n,i,o){a.name=o.name,a.ver=o.version,n(function(){t.getData(),i.checkCvt()},1e3),a.$on("CfgUpdated",function(){a.name=o.name,a.ver=o.version})}])}(),function(){function t(t){var a=new Date(1904,0,1);return a.setSeconds(t),a}angular.module("main").factory("Data",["$rootScope","$http","net","cvt",function(a,e,n){var o=["pDryBlue"],s=["vDryRed","vDryBlue"],l={cTime:null,tObj:new Date,save:!0,o3cal:!1,Cabin:!1,time:[],msg:[],date:{}},r=300,c=!1;l.filter={state:!0,tremain:0};var u=!1;return l.getData=function(){u||(u=!0,promise=e.get(n.address()+"General/Data").then(function(e){l.filter.state=e.data.Filter;var n=e.data.fcycle.tt-e.data.fcycle.te;for(l.filter.tremain=n>0?n:0,i=0;i<o.length;i++)o[i]in e.data&&(l[o[i]]=e.data[o[i]]);for(i=0;i<s.length;i++)s[i]in e.data&&(l[s[i]]=e.data[s[i]]);l.time.length-1>=r&&(c=!0),l.tObj=t(Number(e.data.Time)),l.Cabin=e.data.Cabin,l.msg=e.data.Msg,l.data=e.data,a.$broadcast("dataAvailable"),u=!1},function(){a.$broadcast("dataNotAvailable")})["finally"](function(){u=!1}))},l}])}(),function(){function t(t,a){function e(){if(a.msg.length>0){var e="<span>";for(i=0;i<a.msg.length;i++)e=a.msg[i].search("ERROR")>0?'<span class="cui-msg-error">':(a.msg[i].search("WARNING")>0,'<span class="cui-msg-info">'),n.msgs+=e+a.msg[i]+"</span><br>";for(i=0;i<a.msg.length;i++)a.msg[i].search("ERROR")>0?n.numType[2]+=1:a.msg[i].search("WARNING")>0?n.numType[1]+=1:n.numType[0]+=1;t.$broadcast("msgAvailable")}}var n={numType:[0,0,0],msgs:"",clearMsgArray:function(){this.msgs="",this.numType=[0,0,0],t.$broadcast("countCleared")},resetCount:function(){this.numType=[0,0,0]}};return t.$on("dataAvailable",e),n}angular.module("main").factory("ExMsgSvc",t),t.$inject=["$rootScope","Data"]}(),function(){function t(){return{restrict:"E",scope:{},templateUrl:"app/Messages/msg.html"}}angular.module("main").directive("exMsgDirective",t)}(),function(){angular.module("main").controller("ExMsgCtl",["$scope","ExMsgSvc",function(t,a){t.msgs=a.msgs,t.$on("msgAvailable",function(){t.msgs=a.msgs}),t.clrMsgs=function(){t.msgs="",a.clearMsgArray()}}])}(),function(){angular.module("main").controller("Sidebar",["$scope","$http","Data","net","cvt",function(t,a,e,n,i){t.save=1,t.filter=e.filter.state,t.time="Not connected",t.connected=!1,t.o3On=!1,t.cabin=!1,t.pumpBlocked=!1,t.impBlocked=!1,t.interlock=!1,t.time="Not Connected",t.connected=!1,t.$on("dataAvailable",function(){t.filter=e.filter.state,t.cabin=e.Cabin,t.connected=!0}),t.$on("cvtUpdated",function(){}),t.$on("dataNotAvailable",function(){t.connected=!1}),t.saveData=function(){t.save=!t.save;var e=t.save?1:0;a.get(n.address()+"General/Save?save="+e.toString())},t.setFilter=function(){t.filter=!t.filter;var e=t.filter?1:0;a.get(n.address()+"General/UpdateFilter?State="+e)},t.setCabin=function(){t.cabin=!t.cabin;var e=t.cabin?1:0;a.get(n.address()+"General/Cabin?Cabin="+e)},t.stop=function(){a.get(n.address()+"General/Stop")}}])}(),function(){function t(t,a){var e=function(){console.log("hello")};t.testOptions=[["<em>&tau;</em>",e,["list1","list2"]],["<b>This is awesoem!</b>",function(){console.log("Goodbye!")}]],t.optPData={ylabel:"tau (us)",labels:["t","Cell 1","Cell 2","Cell 3","Cell 4","Cell 5"],legend:"always"},t.pDataCMOptions=[["tau",function(){t.optPData.ylabel="tau (us)",objectData="tau"}],["tau'",function(){t.optPData.ylabel="tau' (us)",objectData="taucorr"}],["stdev",function(){t.optPData.ylabel="std. tau (us)",objectData="stdevtau"}],["max",function(){t.optPData.ylabel="max",objectData="max"}]],t.pData=[[0,0/0,0/0,0/0,0/0,0/0]]}angular.module("main").controller("ExMainCtl",t),t.$inject=["$scope","Data"]}(),function(){angular.module("main").controller("mrAlicatConfigCtlr",["$scope",function(t){function a(t,a){this.address=t,this.id=a}t.entry=new a("A","default"),t.devices=[],t.addDevice=function(){t.devices.push(new a(t.entry.address,t.entry.id))},t.rmDevice=function(){}}])}(),function(){function t(t,a){function e(){this.IDs=[],this.Q=[],this.P=[],this.T=[],this.Q0=[],this.data={},this.Qsp=[],this.clear_data=function(){this.Q=[],this.P=[],this.T=[],this.Q0=[]}}function n(){this.Q=0,this.P=0,this.T=0,this.Q0=0,this.isController=!1,this.Qsp=0,this.label=""}function i(t,e){e?(s.push(u.data[t].P),l.push(u.data[t].T),r.push(u.data[t].Q),c.push(u.data[t].Q0)):(s=[a.tObj,u.data[t].P],l=[a.tObj,u.data[t].T],r=[a.tObj,u.data[t].Q],c=[a.tObj,u.data[t].Q0])}function o(){for(var e="",o=0;o<h.length;o++)h[o]in a.data&&(e=h[o],e in u.data||(u.data[e]=new n,0===u.IDs.length?u.IDs=[e]:u.IDs.push(e),a.data[e].Type.search("C")>=0&&(u.data[e].isController=!0,u.data[e].Qsp=a.data[e].Qsp)),u.data[e].P=a.data[e].P,u.data[e].T=a.data[e].T,u.data[e].Q=a.data[e].Q,u.data[e].label=e);h.forEach(i),p?(u.P.shift(),u.T.shift(),u.Q.shift(),u.Q0.shift()):f+=1,u.P.push(s),u.T.push(l),u.Q.push(r),u.Q0.push(c),p=f>=d,t.$broadcast("FlowDataAvailable")}var s,l,r,c,u=new e,d=300,p=!1,f=0,h=["TestAlicat"];return t.$on("dataAvailable",o),u}angular.module("main").factory("ExFlowSvc",t),t.$inject=["$rootScope","Data"]}(),function(){angular.module("main").controller("ExFooterCtl",["$scope","ExMsgSvc","Data","ExCrdSvc",function(t,a,e,n){t.filter=!0,t.time="Not connected",t.connected=!1,t.o3On=!1,t.cabin=!1,t.pumpBlocked=!1,t.impBlocked=!1,t.interlock=!1,t.num_codes=[0,0,0],t.time="Not Connected",t.$on("dataAvailable",function(){t.time=e.tObj.toLocaleTimeString("en-US",{hour12:!1}),t.filter=e.filter,t.cabin=e.Cabin,t.connected=!0}),t.$on("msgAvailable",function(){t.num_codes=a.numType}),t.$on("countCleared",function(){t.num_codes=a.numType}),t.$on("dataNotAvailable",function(){t.connected=!1})}])}(),function(){angular.module("main").controller("ExPowerCtl",["$scope","cvt",function(t,a){t.power=a.power,t.order=["Pump","O3Gen","Denuder","Laser","TEC"],a.first_call=1,t.toggle=function(e){t.power[e]=!t.power[e];for(var n=0,i=0,o=0;o<t.order.length;o++)t.power.hasOwnProperty(t.order[o])&&(i=t.power[t.order[o]]?1:0,n+=Math.pow(2,o)*i);a.updatePS(n)}}])}(),function(){angular.module("main").controller("mrConfigCtlr",["$scope","$http","Data","net","cvt",function(t,a,e,n,i){i.first_call=1,t.network={ip:n.ip,port:n.port},t.changeIP=function(){n.setIP(t.network.ip)},t.changePort=function(){n.setPort(t.network.port)},t.filter={pos:!0,auto:!0,len:30,per:360,updatePos:function(){this.pos=!this.pos,console.log("updating filter position")},updateAuto:function(){auto=!auto,console.log("update filter auto")}},t.file={folder:"exscalabar\\data",main:"u:\\",mirror:"v:\\",prefix:"ex_",ext:".txt",max:10,save:!0}}])}(),function(){angular.module("main").controller("ExFilterCtl",["$scope","net","$http","cvt","Data",function(t,a,e,n,i){n.first_call=1,t.filter={cycle:n.filter.cycle,position:n.filter.position,updateCycle:function(){n.filter.updateCycle(this.cycle)},updateAuto:function(){this.cycle.auto=!this.cycle.auto,this.updateCycle()},updatePos:function(){n.filter.updatePos(this.position)}},t.tremain=i.filter.tremain,t.state=i.filter.state,t.updateAuto=function(){t.cycle.auto=!t.cycle.auto,t.updateCycle()},t.$on("dataAvailable",function(){t.tremain=i.filter.tremain,t.state=i.filter.state}),t.$on("cvtUpdated",function(){t.filter.cycle=n.filter.cycle})}])}(),function(){function t(t,n){function i(){o=e(n,o),t.$broadcast("crdDataAvaliable")}var o=new a;return t.$on("dataAvailable",i),o}function a(){this.tau=[],this.tau0=[],this.taucorr=[],this.tau0corr=[],this.ext=[],this.extcorr=[],this.stdevtau=[],this.etau=[],this.max=[],this.avg_rd=[],this.fit_rd=[],this.set_history=function(t){if(this.tau.length>t){var a=this.tau.length-t;this.tau.splice(0,a),this.tau.splice(0,a),this.tau0.splice(0,a),this.taucorr.splice(0,a),this.tau0corr.splice(0,a),this.ext.splice(0,a),this.extcorr.splice(0,a),this.stdevtau.splice(0,a),this.etau.splice(0,a),this.max.splice(0,a),n=!0}else n=!1;i=t},this.clear_history=function(){n=!1,this.tau=[],this.tau0=[],this.taucorr=[],this.tau0corr=[],this.ext=[],this.extcorr=[],this.stdevtau=[],this.etau=[],this.max=[]}}function e(t,a){var e=[t.tObj],o=[t.tObj],s=[t.tObj],l=[t.tObj],r=[t.tObj],c=[t.tObj],u=[t.tObj],d=[t.tObj],p=[t.tObj];n?(a.tau.shift(),a.tau0.shift(),a.taucorr.shift(),a.tau0corr.shift(),a.ext.shift(),a.extcorr.shift(),a.stdevtau.shift(),a.etau.shift(),a.max.shift()):n=a.tau.length>=i?!0:!1;for(var f in t.data.CellData)e.push(t.data.CellData[f].extParam.Tau),o.push(t.data.CellData[f].extParam.Tau0),r.push(t.data.CellData[f].extParam.Tau0cor),l.push(t.data.CellData[f].extParam.taucorr),c.push(t.data.CellData[f].extParam.ext),u.push(t.data.CellData[f].extParam.extCorr),s.push(t.data.CellData[f].extParam.stdevTau),d.push(t.data.CellData[f].extParam.eTau),p.push(t.data.CellData[f].extParam.max);a.avg_rd=[];for(var h=0;h<t.data.CellData[0].Ringdowns[0].length;h++){for(var m=[h],v=0;v<t.data.CellData.length;v++)m.push(t.data.CellData[v].Ringdowns[0][h]);a.avg_rd.push(m)}return a.tau.push(e),a.tau0.push(o),a.tau0corr.push(r),a.taucorr.push(l),a.extcorr.push(u),a.ext.push(c),a.stdevtau.push(s),a.etau.push(d),a.max.push(p),a}angular.module("main").factory("ExCrdSvc",t);var n=!1,i=300;t.$inject=["$rootScope","Data"]}(),function(){angular.module("main").controller("ExCrdCtl",["$scope","cvt","ExCrdSvc",function(t,a,e){a.firstcall=1;var n=function(t,a,e,n,i){this.rate=t,this.DC=a,this.k=e,this.en=n,this.id=i};t.setRate=function(){var t=arguments[0],e=arguments[1];a.crd.setLaserRate(t,e)},t.setEn=function(){var e=arguments[0];t.laser_ctl[e].en=!t.laser_ctl[e].en,a.crd.setEnable([t.laser_ctl[0].en,t.laser_ctl[1].en])},t.laser_ctl=[new n(a.crd.fblue,a.crd.dcblue,a.crd.kblue,a.crd.eblue,"Blue Laser"),new n(a.crd.fred,a.crd.dcred,a.crd.kred,a.crd.ered,"Red Laser")],t.pmt=a.crd.kpmt,t.setGain=function(){a.crd.setGain(t.pmt)},t.setLaserGain=function(){a.crd.setLaserGain([t.laser_ctl[0].k,t.laser_ctl[1].k])},t.purge={pos:!1,flow:.16,setValve:function(){this.pos=!this.pos,a.purge.setSw(this.pos)},setFlow:function(){}},t.data=e,t.setEnable=function(e){t.laser_ctl[e].en=!t.laser_ctl[e].en;var n=t.laser_ctl[e].en;switch(e){case 0:a.crd.eblue=n;break;case 1:a.crd.ered=n}},t.ringdownAvg=[[0,0/0,0/0,0/0,0/0,0/0]],t.options={title:"Ringdown Data",ylabel:"Ringdown Magnitude (au)",labels:["t","Cell 1","Cell 2","Cell 3","Cell 4","Cell 5"],legend:"always"},t.$on("crdDataAvaliable",function(){t.data=e,t.ringdownAvg=e.avg_rd}),t.$on("cvtUpdated",function(){t.laser_ctl[0].rate=a.crd.fblue,t.laser_ctl[0].DC=a.crd.dcblue,t.laser_ctl[0].k=a.crd.kblue,t.laser_ctl[0].enabled=a.crd.eblue,t.laser_ctl[1].rate=a.crd.fred,t.laser_ctl[1].DC=a.crd.dcred,t.laser_ctl[1].k=a.crd.kred,t.laser_ctl[1].enabled=a.crd.ered,t.pmt=a.crd.kpmt})}])}(),function(){function t(){var t=function(t,a,e){function n(){i.data=a[o]}var i=this,o="tau";i.cm=[["Tau",function(){o="tau",i.options.ylabel="Tau (us)"}],["Tau'",function(){o="taucorr",i.options.ylabel="Tau' (us)"}],["Standard Deviation",function(){o="stdevtau",i.options.ylabel="Stand. Dev. (us)"}],["Max",function(){o="max",i.options.ylabel="Max (a.u.)"}],null,["Clear Data",function(){a.clear_history()}],["Length",null,[["30",function(){a.set_history(30)}],["60",function(){a.set_history(60)}],["120",function(){a.set_history(120)}],["150",function(){a.set_history(150)}],["300",function(){a.set_history(300)}]]]],i.options={ylabel:"Tau (us)",labels:["t","Cell 1","Cell 2","Cell 3","Cell 4","Cell 5"],legend:"always",axes:{y:{axisLabelWidth:70,drawGrid:e.crd.yGrid},x:{drawAxis:!0,drawGrid:e.crd.yGrid,axisLabelFormatter:function(t){return Dygraph.zeropad(t.getHours())+":"+Dygraph.zeropad(t.getMinutes())+":"+Dygraph.zeropad(t.getSeconds())}}}},void 0!==i.title&&(i.options.title=i.title),i.data=[[0,0/0,0/0,0/0,0/0,0/0]],t.$on("crdDataAvaliable",n)};return t.$inject=["$rootScope","ExCrdSvc","ExReadCfgSvc"],{restrict:"E",require:"contextMenu",scope:{title:"@?"},controller:t,controllerAs:"vm",bindToController:!0,template:'<context-menu menu-options="vm.cm"><dy-graph options="vm.options" data="vm.data" ></dy-graph></context-menu>'}}angular.module("main").directive("exCrdplot",t)}(),function(){function t(t,a,e){function n(){t.data=e}t.data=e,t.$on("pasDataAvailable",n),a.first_call=1}angular.module("main").controller("ExPasCtl",t),t.$inject=["$scope","cvt","ExPasSvc"]}(),function(){function t(t,n){var i=new a;return t.$on("dataAvailable",function(){i=e(n,i),t.$broadcast("pasDataAvaliable")}),i}function a(){this.f0=[],this.IA=[],this.Q=[],this.p=[],this.abs=[],this.wvfm={micf:[],mict:[],pd:[]},this.drive=!1,this.set_history=function(t){},this.clear=function(){this.f0=[],this.IA=[],this.Q=[],this.p=[],this.abs=[],n=!1}}function e(t,a){var e=[t.tObj],o=[t.tObj],s=[t.tObj],l=[t.tObj],r=[t.tObj];n?(a.f0.shift(),a.IA.shift(),a.Q.shift(),a.p.shift(),a.abs.shift()):n=a.f0.length>=i?!0:!1;for(var c in t.data.PAS.CellData)e.push(t.data.PAS.CellData[c].derived.f0),o.push(t.data.PAS.CellData[c].derived.IA),s.push(t.data.PAS.CellData[c].derived.Q),l.push(t.data.PAS.CellData[c].derived.noiseLim),r.push(t.data.PAS.CellData[c].derived.ext);for(a.f0.push(e),a.IA.push(o),a.Q.push(s),a.p.push(l),a.abs.push(r),a.drive=t.data.PAS.Drive,a.wvfm.mict=[],a.wvfm.micf=[],a.wvfm.pd=[],k=0;k<t.data.PAS.CellData[0].MicFreq.Y.length;k++){var u=[k],d=[k],p=[k];for(j=0;j<t.pas.CellData.length;j++)u.push(t.data.PAS.CellData[j].MicFreq.Y[j]),d.push(t.data.PAS.CellData[j].MicTime.Y[j]),p.push(t.data.PAS.CellData[c].PhotoDiode.Y[j]);a.wvfm.micf.push(u),a.wvfm.mict.push(d),a.wvfm.pd.push(p)}return a}angular.module("main").factory("ExPasSvc",t);var n=!1,i=300;t.$inject=["$rootScope","Data"]}(),function(){angular.module("main").controller("pasSpk",["$scope","cvt","Data",function(t,a,e){var n=10,i=5;t.speaker=a.pas.spk;var o={high:3e3,low:500};t.$on("cvtUpdated",function(){t.speaker=a.pas.spk}),t.setPos=function(){t.speaker.pos=!t.speaker.pos,a.pas.spk.updateCtl(t.speaker)},t.updateSpkV=function(){t.speaker.vrange>n?t.speaker.vrange=n:t.speaker.vrange<0&&(t.speaker.vrange=0),t.speaker.voffset>i?t.speaker.voffset=i:t.speaker.voffset<0&&(t.speaker.voffset=0),a.pas.spk.updateCtl(t.speaker)},t.updateSpkF=function(){t.speaker.f0>o.high?t.speaker.f0=o.high:t.speaker.f0<o.low&&(t.speaker.f0=o.low),a.pas.spk.updateCtl(t.speaker)},t.updateCycle=function(){a.pas.spk.updateCycle(t.speaker.auto,t.speaker.period,t.speaker.length)},t.updateAuto=function(){t.speaker.auto=!t.speaker.auto,t.updateCycle()}}])}(),function(){function t(t,a,e,n,i){this.Vrange=t,this.Voffset=a,this.f0=e,this.modulation=n,this.lasEn=!1}angular.module("main").controller("pasLas",["$scope","cvt","Data",function(a,e,n){for(a.lasCtl=[],a.testVal="hello",i=0;i<e.pas.las.vr.length;i++)a.lasCtl.push(new t(e.pas.las.vr[i],e.pas.las.voffset[i],e.pas.las.f0[i],e.pas.las.modulation[i],e.pas.las.enable[i]));a.$on("dataAvailable",function(){if(n.pas.drive)for(i=0;i<n.pas.cell.length;i++)a.lasCtl[i].f0=a.data.cell[i].f0[0].y}),a.$on("cvtUpdated",function(){for(i=0;i<e.pas.las.vr.length;i++)a.lasCtl[i].vr=e.pas.las.vr[i],a.lasCtl[i].vo=e.pas.las.voffset[i],a.lasCtl[i].f0=e.pas.las.f0[i],a.lasCtl[i].mod=e.pas.las.modulation[i],a.lasCtl[i].en=e.pas.las.enable[i]}),a.updateMod=function(t){a.lasCtl[t].modulation=!a.lasCtl[t].modulation;var n=[];for(j=0;j<a.lasCtl.length;j++)n.push(a.lasCtl[j].modulation);e.pas.las.updateMod(n)},a.updateVr=function(){var t=[];for(i=0;i<a.lasCtl.length;i++)t.push(a.lasCtl[i].Vrange);e.pas.las.setVr(t)},a.updateVo=function(){var t=[];for(i=0;i<a.lasCtl.length;i++)t.push(a.lasCtl[i].Voffset);e.pas.las.setVo(t)},a.updatef0=function(){var t=[];for(i=0;i<a.lasCtl.length;i++)t.push(a.lasCtl[i].f0);e.pas.las.setf0(t)},a.updateEnable=function(t){a.lasCtl[t].lasEn=!a.lasCtl[t].lasEn;var n=[];for(t=0;t<a.lasCtl.length;t++)n.push(a.lasCtl[t].lasEn);e.pas.las.updateEnable(n)}}])}(),function(){function t(t){var a=function(a,e){function n(){i.data=e[o]}var i=this,o="IA";i.cm=[["<em>IA</em>",function(){o="IA",i.options.ylabel="IA (a.u.)"}],["<em>f<sub>0</sub></em>",function(){o="f0",i.options.ylabel="<em>f<sub>0</sub></em> (Hz)"}],["Quality",function(){o="Q",i.options.ylabel="Quality (a.u.)"}],["Noise Floor",function(){o="p",i.options.ylabel="Noise (a.u.)"}],["<em>&sigma;<sub>abs</sub></em>",function(){o="abs",i.options.ylabel="<em>&sigma;<sub>abs</sub></em> (Mm<sup>-1</sup>)"}],null,["Clear Data",function(){e.clear()}],["History",null,[["30",function(){e.set_history(30)}],["60",function(){e.set_history(60)}],["120",function(){e.set_history(120)}],["150",function(){e.set_history(150)}],["300",function(){e.set_history(300)}]]],["Grid",null,[["Grid X",function(){}],["Grid Y",function(){}],["Enable",function(){}],["Disable",function(){}]]]],i.options={ylabel:"IA (a.u.)",labels:["t","Cell 1","Cell 2","Cell 3","Cell 4","Cell 5"],legend:"always",axes:{y:{axisLabelWidth:70,drawGrid:t.pas.yGrid},x:{drawAxis:!0,drawGrid:t.pas.xGrid,axisLabelFormatter:function(t){return Dygraph.zeropad(t.getHours())+":"+Dygraph.zeropad(t.getMinutes())+":"+Dygraph.zeropad(t.getSeconds())}}}},void 0!==i.title&&(i.options.title=i.title),i.data=[[0,0/0,0/0,0/0,0/0,0/0]],a.$on("pasDataAvaliable",n)};return a.$inject=["$rootScope","ExPasSvc"],{restrict:"E",scope:{title:"@?"},controller:a,controllerAs:"vm",bindToController:!0,template:'<context-menu menu-options="vm.cm"><dy-graph options="vm.options" data="vm.data"></dy-graph></context-menu>'}}angular.module("main").directive("exPasplot",t),t.$inject=["ExReadCfgSvc"]}(),function(){function t(t,a,e){t.Devices={},t.updateSP=function(){var t=arguments[0];a.flows.updateSP(t.ID,t.sp)},t.$on("dataAvailable",function(){t.Devices=e.data})}angular.module("main").controller("ExFlowCtl",t),t.$inject=["$scope","Data","cvt","ExFlowSvc"]}(),function(){function t(){var t=function(t,a,e){function n(){var t=["t"].concat(a.IDs);t!==i.options.labels&&(i.options.labels=t.slice()),i.data=a[o]}var i=this,o="P";i.ref={},i.cm=[["P",function(){o="P",i.options.ylabel="P (mb)",i.options.axes.y.valueRange=[null,null]}],["T",function(){o="T",i.options.ylabel="T (degC)",i.options.axes.y.valueRange=[null,null]}],["Q",function(){o="Q",i.options.ylabel="Q (lpm)",i.options.axes.y.valueRange=[null,null]}],["Q0",function(){o="Q0",i.options.ylabel="Q0 (slpm)",i.options.axes.y.valueRange=[null,null]}],null,["Controller",null,[["Controller 1",function(){console.log("Controller 1 fired.")}],["Controller 2",function(){console.log("Controller 2 fired.")}]],["Enable All",function(){console.log("Enabling all.")}],["Clear Data",function(){a.clear_data()}]],["Autoscale",null,[["Autoscale 1x",function(){i.options.axes.y.valueRange=i.ref.yAxisRange()}],["Autoscale",function(){i.options.axes.y.valueRange=[null,null]}]]]],i.options={ylabel:"P (mb)",labels:["t","Alicat0"],legend:"always",axes:{y:{axisLabelWidth:70,drawGrid:e.flow.yGrid},x:{drawAxis:!0,drawGrid:e.flow.xGrid,axisLabelFormatter:function(t){return Dygraph.zeropad(t.getHours())+":"+Dygraph.zeropad(t.getMinutes())+":"+Dygraph.zeropad(t.getSeconds())}}},labelsUTC:!0},void 0!==i.title&&(i.options.title=i.title),i.data=[[0,0/0]],t.$on("FlowDataAvailable",n)};return t.$inject=["$rootScope","ExFlowSvc","ExReadCfgSvc"],{restrict:"E",require:"contextMenu",scope:{title:"@?"},controller:t,controllerAs:"vm",bindToController:!0,template:'<context-menu menu-options ="vm.cm"><dy-graph options="vm.options" ref= "vm.ref" data="vm.data" ></dy-graph></context-menu>'}}angular.module("main").directive("exFlowplot",t)}(),function(){angular.module("main").controller("ExHumidityCtl",["$scope","cvt","Data",function(t,a,e){a.first_call=1,t.h=a.humidifier,t.setEnable=function(a){t.h[a].en=!t.h[a].en,t.updateHum(a)},t.updateHum=function(){var t=arguments[0];a.humidifier[t].updateParams()},t.ctlrOutData=[[0,0/0,0/0]],t.RH=[[0,0/0,0/0]],t.optCtlOut={ylabel:"Controller Output",labels:["t","med","high"],legend:"always"},t.optRH={ylabel:"RH (%)",labels:["t","med","high"],legend:"always"}}])}(),function(){angular.module("main").controller("startCal",["$scope","$http","net","cvt",function(t,a,e,n){t.cal=n.ozone,t.startCalibration=function(){t.cal=!t.cal;var i=t.cal?1:0;n.ozone=t.cal,a.get(e.address()+"General/ozone?start="+i.toString())}}])}(),function(){angular.module("main").controller("O3Table",["$scope","tableService",function(t,a){t.table_vals=[{id:"Wait",step:"Wait",descr:"Set a wait time in the ozone cal in seconds"},{id:"Filter",step:"Filter",descr:"Boolean that sets the filter state."},{id:"Speaker",step:"Speaker",descr:"Boolean that sets the speaker state."},{id:"O2-Valve",step:"O2 Valve",descr:"Boolean that sets the O2 valve position."},{id:"O3-Valve",step:"O3 Valve",descr:"Boolean that sets the O3 valve state."},{id:"O3-Generator",step:"O3 Generator",descr:"Boolean that sets the O3 generator state."},{id:"QO2",step:"QO2",descr:"Numeric to set the oxygen flow rate"}],t.clickRow=function(t){a.setTab(t.id.toString())}}])}(),function(){angular.module("main").factory("tableService",["$rootScope",function(t){var a={curTab:"",getTab:function(){return this.curTab},setTab:function(a){this.curTab=a,t.$broadcast("handleBroadcast")}};return a}])}(),function(){angular.module("main").factory("SaveData",function(){var t={data:[],setData:function(t){this.data=t},getData:function(){return this.data}};return t})}(),function(){angular.module("main").controller("Save",["$scope","SaveData","$http","net",function(t,a,e,n){t.cal_file="default",t.save=function(){var i='<?xml version="1.0" encoding="utf-8"?>\r\n<OZONE>\r\n';a.getData().forEach(function(t){i+="	<"+t.id+">"+t.val+"</"+t.id+">\r\n"}),i+="</OZONE>",e({method:"POST",url:n.address()+"Calibration/saveCalFile?file_name="+t.cal_file+".xml",data:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}])}(),function(){angular.module("main").controller("InputTable",["$scope","tableService","SaveData",function(t,a,e){t.data=[],t.$on("handleBroadcast",function(){var n=a.getTab(),i="";switch(n){case"O3-Valve":case"O2-Valve":case"O3-Generator":case"Filter":i="FALSE";break;case"Wait":case"Speaker":i="20";break;case"QO2":i="100"}t.data.push({id:n,val:i}),e.setData(t.data)})}])}(),function(){function t(){return{restrict:"E",scope:{},templateUrl:"sidebar/side.html"}}angular.module("main").directive("sidebar",t)}(),function(){angular.module("main").factory("navservice",["$http","net","cvt",function(t,a,e){var n={};return n.stop=function(){t.get(a.address()+"General/Stop")},n.save=function(e){var n=e?1:0;t.get(a.address()+"General/Save?save="+n.toString())},n}])}(),function(){function t(){return{restrict:"E",scope:{name:"=?"},templateUrl:"nav/navi.html"}}angular.module("main").directive("navi",t)}(),function(){angular.module("main").controller("navctlr",["$scope","navservice",function(t,a){t.save=!0,t.updateSave=function(){t.save=!t.save,a.save(t.save)},t.stop=function(){a.stop()}}])}();