!function(){angular.module("main",["ngRoute","ui.bootstrap","ui.bootstrap.contextMenu","dygraph","cirrus.ui.ibutton","cirrus.ui.inumeric","cirrus.ui.string","ngSanitize","ui.bootstrap.dropdownToggle","angular-svg-round-progressbar"])}(),function(){angular.module("main").factory("net",function(){return localStorage.ip||(localStorage.ip="192.168.0.73"),localStorage.port||(localStorage.port="8001"),{ip:localStorage.ip,port:localStorage.port,getNetworkParams:function(){return{ip:this.ip,port:this._port}},setNetworkParams:function(t,e){this._ip=t,this.port=e,localStorage.ip=t,localStorage.port=e},setIP:function(t){this.ip=t,localStorage.ip=t},setPort:function(t){this.port=t,localStorage.port=t},address:function(){return"http://"+this.ip+":"+this.port+"/xService/"}}})}(),function(){function t(t,e){for(var a in t)if(t[a].id===e)return!0;return!1}function e(t,e,a,n,i,o){this.label=t,this.id=e,this.ctlr=a,this.sn=n,this.sp=i,this.address=o}function a(t,e){var a=t,n=e;this.net=n,this.fred=1e3,this.dcred=50,this.fblue=2e3,this.dcblue=50,this.kred=1,this.kblue=1,this.kpmt=[0,0,0,0,0],this.eblue=!0,this.ered=!0,this.setLaserRate=function(t,e){var i="CRDS_CMD/fblue?Rate="+e;t?(i="CRDS_CMD/fred?Rate="+e,this.fred=e):this.fblue=e,a.get(n.address()+i)},this.setEnable=function(t){this.eblue=t[0],this.ered=t[1];var e=this.ered?1:0,i=this.eblue?1:0,o="CRDS_CMD/LaserEnable?Red="+e+"&Blue="+i;a.get(n.address()+o)},this.setGain=function(t){this.kpmt=t,a.get(n.address()+"CRDS_CMD/Vpmt?V="+t.toString())},this.setLaserGain=function(t){this.kred=t[1],this.kblue=t[0],a.get(n.address()+"CRDS_CMD/LaserGain?B1=0&B0="+t[0]+"&R="+t[1])}}function n(t,e){var a=t,n=e;this.write_wvfm_state=!1,this.send_wvfm_state=!0,this.spk={vrange:5,voffset:0,f0:1350,df:100,pos:!0,auto:!1,period:360,length:30},this.las={vr:[5,5,5,5,5],voffset:[1,2,3,4,5],f0:[1351,1352,1353,1354,1355],modulation:[0,0,0,0,0],enable:[!1,!1,!1,!1,!1]},this.las.setf0=function(t){this.f0=t,a.get(n.address()+"PAS_CMD/UpdateFr?f0="+t.join(","))},this.las.setVr=function(t){this.vr=t,a.get(n.address()+"PAS_CMD/UpdateVrange?Vrange="+t.join(","))},this.send_wvfm=function(t){var e=t?1:0;this.send_wvfm_state=t,console.log("New value for waveform retrieval is "+e),a.get(n.address()+"PAS_CMD/wvfm?write="+e)},this.write_wvfm=function(t){var e=t?1:0;this.write_wvfm_state=t,console.log("New value for waveform retrieval is "+e),a.get(n.address()+"PAS_CMD/WVFM_to_File?Write_Data="+e)},this.las.setVo=function(t){this.voffset=t,a.get(n.address()+"PAS_CMD/UpdateVoffset?Voffset="+t.join(","))},this.las.updateMod=function(t){this.moduldation=t;for(var e=[],i=0;i<t.length;i++)e.push(t[i]?1:0);a.get(n.address()+"PAS_CMD/modulation?val="+e.join(","))},this.las.updateEnable=function(t){this.enable=t;for(var e=0,i=0;i<t.length;i++)e+=t[i]?Math.pow(2,i):0;a.get(n.address()+"PAS_CMD/UpdateLaserEnable?LasEnByte="+e)},this.spk.updateCtl=function(t){var e=t.pos?1:0;a.get(n.address()+"PAS_CMD/SpkSw?SpkSw="+e),a.get(n.address()+"PAS_CMD/Spk?df="+this.df+"&f0="+this.f0),a.get(n.address()+"PAS_CMD/UpdateSpkVparams?Voffset="+this.voffset+"&Vrange="+this.vrange)},this.spk.updateCycle=function(t,e,i){this.auto=t,this.length=i,this.period=e;var o=t?1:0;a.get(n.address()+"PAS_CMD/UpdateSpkCycle?Length="+i+"&Period="+e+"&Cycle="+o)}}angular.module("main").factory("cvt",["$http","net","$rootScope",function(i,o,s){function l(t,e,a,n,i,o){this.p=t,this.i=e,this.d=a,this.sp=n,this.en=i,this.updateEn=function(){},this.updateParams=function(t){},this.name=o}function r(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}var c={save:!0,ozone:!1,filter_pos:!0,first_call:1,fctl:[],power:{Pump:!1,O3Gen:!1,Denuder:!1,Laser:!1,TEC:!1},purge:{setSw:function(t){this.pos=t;var e=t?1:0;i.get(o.address()+"General/PurgeSwitch?val="+e)},pos:!0},alicat:[],vaisala:[],mTEC:[],tec:{},ppt:[]};return c.humidifier=[new l(.75,1,0,90,!1,"Medium"),new l(.75,1,0,80,!1,"High")],c.pas=new n(i,o),c.crd=new a(i,o),c.filter={cycle:{period:360,length:20,auto:!1},position:!0,updateCycle:function(t){this.cycle=t;var e=this.cycle.auto?1:0;i.get(o.address()+"General/FilterCycle?Length="+this.cycle.length+"&Period="+this.cycle.period+"&auto="+e)},updatePos:function(t){this.position=t;var e=this.position?1:0;i.get(o.address()+"General/UpdateFilter?State="+e)}},c.tec.updateSP=function(t){i.get(o.address()+"General/DevSP?SP="+t+"&DevID=tetech")},c.tec.updateMult=function(t){i.get(o.address()+"tetech/multipliers?mult="+t.toString())},c.checkCvt=function(){promise=i.get(o.address()+"General/cvt?force="+c.first_call).then(function(a){if(first_Call=0,!r(a.data)){var n=a.data.crd,i=a.data.pas,o=a.data.device;for(var l in o){var u=o[l];switch(u.type){case"alicat":c.alicat.length>0&&!t(c.alicat,l)?c.alicat.push(new e(u.label,l,u.controller,u.sn,u.sp,u.address)):c.alicat=[new e(u.label,l,u.controller,u.sn,u.sp,u.address)];break;case"mTEC":c.mTEC.length>0&&!t(c.mTEC,l)?c.mTEC.push(new e(u.label,l,u.controller,u.sn,u.sp,u.address)):c.mTEC=[new e(u.label,l,u.controller,u.sn,u.sp,u.address)];break;case"vaisala":c.vaisala.length>0&&!t(c.vaisala,l)?c.vaisala.push(new e(u.label,l,u.controller,u.sn,u.sp,u.address)):c.vaisala=[new e(u.label,l,u.controller,u.sn,u.sp,u.address)];break;case"ppt":c.ppt.length>0&&!t(c.ppt,l)?c.ppt.push(new e(u.label,l,u.controller,u.sn,u.sp,u.address)):c.ppt=[new e(u.label,l,u.controller,u.sn,u.sp,u.address)];break;case"TEC":r(c.tec)&&(c.tec=new e(u.label,l,u.controller,u.sn,u.sp,u.address));break;default:console.log("Unexpected device found...")}s.$broadcast("deviceListRefresh")}var d=a.data.Humidifier;c.humidifier[0].p=d.Med.p,c.humidifier[0].i=d.Med.i,c.humidifier[0].d=d.Med.d,c.humidifier[0].en=d.Med.ctl,c.humidifier[0].sp=d.Med.rhsp,c.humidifier[1].p=d.High.p,c.humidifier[1].i=d.High.i,c.humidifier[1].d=d.High.d,c.humidifier[1].en=d.High.ctl,c.humidifier[1].sp=d.High.rhsp,c.crd.fred=n.red.f,c.crd.fblue=n.blue.f,c.crd.dcred=n.red.dc,c.crd.dcblue=n.blue.dc,c.crd.kpmt=n.kpmt,c.pas.las.f0=i.las.f0,c.pas.las.vr=i.las.vrange,c.pas.las.voffset=i.las.voffset,c.pas.las.enable=i.las.enabled,c.pas.las.modulation=i.las.modulation,c.pas.spk.f0=i.spk.fcenter,c.pas.spk.df=i.spk.df,c.pas.spk.vrange=i.spk.vrange,c.pas.spk.voffset=i.spk.voffset,c.pas.spk.auto=i.spk.cycle,c.pas.spk.length=i.spk.length,c.pas.spk.period=i.spk.period,c.pas.spk.pos=i.spk.enabled,c.filter.cycle.period=a.data.Filter.period,c.filter.cycle.length=a.data.Filter.length,c.filter.cycle.auto=a.data.Filter.auto,c.filter.position=a.data.general.filter_pos;for(var p=Number(a.data.general.power).toString(2);p.length<5;)p+="0";c.power.Pump="1"==p[4],c.power.O3Gen="1"==p[3],c.power.Denuder="1"==p[2],c.power.Laser="1"==p[1],c.power.TEC="1"==p[0],s.$broadcast("cvtUpdated")}},function(t){s.$broadcast("cvtNotAvailable")})["finally"](function(){c.first_call=0})},c.flows={},c.flows.updateSP=function(t,e){c.flows[t]=e,i.get(o.address()+"General/DevSP?SP="+e+"&DevID="+t)},c.updatePS=function(t){i.get(o.address()+"General/PowerSupply?val="+t)},c}])}(),function(){angular.module("main").config(["$routeProvider",function(t){t.when("/CRDS",{templateUrl:"html/crds.html"}).when("/PAS",{templateUrl:"html/pas.html"}).when("/O3",{templateUrl:"html/ozone.html"}).when("/",{templateUrl:"html/main.html"}).when("/Flows",{templateUrl:"html/flows.html"}).when("/Temperature",{templateUrl:"html/temperature.html"}).when("/Humidifier",{templateUrl:"html/humidifier.html"}).when("/Common",{templateUrl:"html/common.html"}).when("/Config",{templateUrl:"html/config.html"}).when("/msg",{templateUrl:"html/msg.html"}).when("/Checklist",{templateUrl:"html/checklist.html"}).when("/Housekeeping",{templateUrl:"html/housekeeping.html"})}])}(),function(){function t(t,e,a){var n={name:"",version:"",pas:{},crd:{},flow:{},tec:{},ppt:{},mtec:{},main_path:""},i=e.$$absUrl,o=i.search("#/");i=i.slice(0,o);var s="/"===i.slice(-1)?"":"/";n.main_path=i+s;var l=n.main_path+"ui.json";return t.get(l).then(function(t){n.name=t.data.name,n.version=t.data.version,n.pas=t.data.pasplot,n.crd=t.data.crdplot,n.flow=t.data.flowplot,n.tec=t.data.tec,n.ppt=t.data.ppt,n.vaisala=t.data.vaisala,a.$broadcast("CfgUpdated")},function(){console.log("Configuration file not found."),n.name="EXSCALABAR",n.version="0.1.0"})["finally"](function(){}),n}angular.module("main").factory("ExReadCfgSvc",t),t.$inject=["$http","$location","$rootScope"]}(),function(){angular.module("main").controller("ExMainCtl",["Data","$scope","$rootScope","$interval","cvt","ExReadCfgSvc","ExChecklistSvc",function(t,e,a,n,i,o,s){e.name=o.name,e.ver=o.version,n(function(){t.getData(),i.checkCvt()},1e3),s.load(),e.$on("CfgUpdated",function(){e.name=o.name,e.ver=o.version})}])}(),function(){function t(t){var e=new Date(1904,0,1);return e.setSeconds(t),e}function e(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}angular.module("main").factory("Data",["$rootScope","$http","net","cvt",function(a,n,i){var o=["pDryBlue"],s=["vDryRed","vDryBlue"],l={cTime:null,tObj:new Date,save:!0,o3cal:!1,Cabin:!1,pas:{},crd:{},time:[],msg:[],date:{}},r=300,c=!1;l.filter={state:!0,tremain:0};var u=!1;return l.getData=function(){u||(u=!0,promise=n.get(i.address()+"General/Data").then(function(n){if(e(n.data))a.$broadcast("dataNotAvailable");else{l.filter.state=n.data.Filter;var i=n.data.fcycle.tt-n.data.fcycle.te;for(l.filter.tremain=i>0?i:0,l.pas=n.data.PAS,u=0;u<o.length;u++)o[u]in n.data&&(l[o[u]]=n.data[o[u]]);for(var u=0;u<s.length;u++)s[u]in n.data&&(l[s[u]]=n.data[s[u]]);l.time.length-1>=r&&(c=!0),l.tObj=t(Number(n.data.Time)),l.Cabin=n.data.Cabin,l.msg=n.data.Msg,l.data=n.data,a.$broadcast("dataAvailable")}},function(){a.$broadcast("dataNotAvailable")})["finally"](function(){u=!1}))},l}])}(),function(){function t(t,e){function a(){if(e.msg.length>0){var a="<span>";for(i=0;i<e.msg.length;i++)a=e.msg[i].search("ERROR")>0?'<span class="cui-msg-error">':(e.msg[i].search("WARNING")>0,'<span class="cui-msg-info">'),n.msgs+=a+e.msg[i]+"</span><br>";for(i=0;i<e.msg.length;i++)e.msg[i].search("ERROR")>0?n.numType[2]+=1:e.msg[i].search("WARNING")>0?n.numType[1]+=1:n.numType[0]+=1;t.$broadcast("msgAvailable")}}var n={numType:[0,0,0],msgs:"",clearMsgArray:function(){this.msgs="",this.numType=[0,0,0],t.$broadcast("countCleared")},resetCount:function(){this.numType=[0,0,0]}};return t.$on("dataAvailable",a),n}angular.module("main").factory("ExMsgSvc",t),t.$inject=["$rootScope","Data"]}(),function(){function t(){return{restrict:"E",scope:{},templateUrl:"app/Messages/msg.html"}}angular.module("main").directive("exMsgDirective",t)}(),function(){angular.module("main").controller("ExMsgCtl",["$scope","ExMsgSvc",function(t,e){t.msgs=e.msgs,t.$on("msgAvailable",function(){t.msgs=e.msgs}),t.clrMsgs=function(){t.msgs="",e.clearMsgArray()}}])}(),function(){angular.module("main").controller("Sidebar",["$scope","$http","Data","net","cvt",function(t,e,a,n,i){t.save=1,t.filter=a.filter.state,t.time="Not connected",t.connected=!1,t.o3On=!1,t.cabin=!1,t.pumpBlocked=!1,t.impBlocked=!1,t.denuder_bypass=!1,t.interlock=!1,t.time="Not Connected",t.connected=!1,t.$on("dataAvailable",function(){t.filter=a.filter.state,t.cabin=a.Cabin,t.connected=!0}),t.$on("cvtUpdated",function(){}),t.$on("dataNotAvailable",function(){t.connected=!1}),t.saveData=function(){t.save=!t.save;var a=t.save?1:0;e.get(n.address()+"General/Save?save="+a.toString())},t.setFilter=function(){t.filter=!t.filter;var a=t.filter?1:0;e.get(n.address()+"General/UpdateFilter?State="+a)},t.setDenuderBypass=function(){t.filter=!t.denuder_bypass;var a=t.denuder_bypass?1:0;e.get(n.address()+"General/DenudedBypass?val="+a)},t.setCabin=function(){t.cabin=!t.cabin;var a=t.cabin?1:0;e.get(n.address()+"General/Cabin?val="+a)},t.stop=function(){e.get(n.address()+"General/Stop")}}])}(),function(){angular.module("main").controller("mrAlicatConfigCtlr",["$scope",function(t){function e(t,e){this.address=t,this.id=e}t.entry=new e("A","default"),t.devices=[],t.addDevice=function(){t.devices.push(new e(t.entry.address,t.entry.id))},t.rmDevice=function(){}}])}(),function(){function t(t,e,a){function n(){this.IDs=[],this.Q=[],this.P=[],this.T=[],this.Q0=[],this.data={},this.Qsp=[],this.clear_data=function(){this.Q=[],this.P=[],this.T=[],this.Q0=[],f=!1,h=0}}function i(){this.Q=0,this.P=0,this.T=0,this.Q0=0,this.isController=!1,this.Qsp=0,this.label=""}function o(t,a){var n=t.id;a?(l.push(d.data[n].P),r.push(d.data[n].T),c.push(d.data[n].Q),u.push(d.data[n].Q0)):(l=[e.tObj,d.data[n].P],r=[e.tObj,d.data[n].T],c=[e.tObj,d.data[n].Q],u=[e.tObj,d.data[n].Q0])}function s(){for(var a="",n=0;n<m.length;n++)m[n].id in e.data&&(a=m[n].id,a in d.data||(d.data[a]=new i,0===d.IDs.length?d.IDs=[a]:d.IDs.push(a),e.data[a].Type.search("C")>=0&&(d.data[a].isController=!0,d.data[a].Qsp=e.data[a].Qsp)),d.data[a].P=e.data[a].P,d.data[a].T=e.data[a].T,d.data[a].Q=e.data[a].Q,d.data[a].label=m[n].label);m.forEach(o),f?(d.P.shift(),d.T.shift(),d.Q.shift(),d.Q0.shift()):h+=1,d.P.push(l),d.T.push(r),d.Q.push(c),d.Q0.push(u),f=h>=p,t.$broadcast("FlowDataAvailable")}var l,r,c,u,d=new n,p=300,f=!1,h=0,m=a.alicat;return t.$on("dataAvailable",s),t.$on("deviceListRefresh",function(){m=a.alicat}),d}angular.module("main").factory("ExFlowSvc",t),t.$inject=["$rootScope","Data","cvt"]}(),function(){angular.module("main").controller("ExFooterCtl",["$scope","ExMsgSvc","Data","ExCrdSvc",function(t,e,a,n){t.filter=!0,t.time="Not connected",t.connected=!1,t.o3On=!1,t.cabin=!1,t.pumpBlocked=!1,t.impBlocked=!1,t.interlock=!1,t.num_codes=[0,0,0],t.time="Not Connected",t.$on("dataAvailable",function(){t.time=a.tObj.toLocaleTimeString("en-US",{hour12:!1}),t.filter=a.filter,t.cabin=a.Cabin,t.connected=!0}),t.$on("msgAvailable",function(){t.num_codes=e.numType}),t.$on("countCleared",function(){t.num_codes=e.numType}),t.$on("dataNotAvailable",function(){t.connected=!1})}])}(),function(){angular.module("main").controller("ExPowerCtl",["$scope","cvt",function(t,e){t.power=e.power,t.order=["Pump","O3Gen","Denuder","Laser","TEC"],e.first_call=1,t.toggle=function(a){t.power[a]=!t.power[a];for(var n=0,i=0,o=0;o<t.order.length;o++)t.power.hasOwnProperty(t.order[o])&&(i=t.power[t.order[o]]?1:0,n+=Math.pow(2,o)*i);e.updatePS(n)}}])}(),function(){angular.module("main").controller("mrConfigCtlr",["$scope","$http","Data","net","cvt",function(t,e,a,n,i){i.first_call=1,t.network={ip:n.ip,port:n.port},t.changeIP=function(){n.setIP(t.network.ip)},t.changePort=function(){n.setPort(t.network.port)},t.filter={pos:!0,auto:!0,len:30,per:360,updatePos:function(){this.pos=!this.pos,console.log("updating filter position")},updateAuto:function(){auto=!auto,console.log("update filter auto")}},t.file={folder:"exscalabar\\data",main:"u:\\",mirror:"v:\\",prefix:"ex_",ext:".txt",max:10,save:!0}}])}(),function(){angular.module("main").controller("ExFilterCtl",["$scope","net","$http","cvt","Data",function(t,e,a,n,i){n.first_call=1,t.filter={cycle:n.filter.cycle,position:n.filter.position,updateCycle:function(){n.filter.updateCycle(this.cycle)},updateAuto:function(){this.cycle.auto=!this.cycle.auto,this.updateCycle()},updatePos:function(){n.filter.updatePos(this.position)}},t.tremain=i.filter.tremain,t.state=i.filter.state,t.updateAuto=function(){t.cycle.auto=!t.cycle.auto,t.updateCycle()},t.$on("dataAvailable",function(){t.tremain=i.filter.tremain,t.state=i.filter.state}),t.$on("cvtUpdated",function(){t.filter.cycle=n.filter.cycle})}])}(),function(){function t(t,n){function i(){o=a(n,o),t.$broadcast("crdDataAvaliable")}var o=new e;return t.$on("dataAvailable",i),o}function e(){this.tau=[],this.tau0=[],this.taucorr=[],this.tau0corr=[],this.ext=[],this.extcorr=[],this.stdevtau=[],this.etau=[],this.max=[],this.avg_rd=[],this.fit_rd=[],this.set_history=function(t){if(this.tau.length>t){var e=this.tau.length-t;this.tau.splice(0,e),this.tau.splice(0,e),this.tau0.splice(0,e),this.taucorr.splice(0,e),this.tau0corr.splice(0,e),this.ext.splice(0,e),this.extcorr.splice(0,e),this.stdevtau.splice(0,e),this.etau.splice(0,e),this.max.splice(0,e),n=!0}else n=!1;i=t},this.clear_history=function(){n=!1,this.tau=[],this.tau0=[],this.taucorr=[],this.tau0corr=[],this.ext=[],this.extcorr=[],this.stdevtau=[],this.etau=[],this.max=[]}}function a(t,e){var a=[t.tObj],o=[t.tObj],s=[t.tObj],l=[t.tObj],r=[t.tObj],c=[t.tObj],u=[t.tObj],d=[t.tObj],p=[t.tObj];n?(e.tau.shift(),e.tau0.shift(),e.taucorr.shift(),e.tau0corr.shift(),e.ext.shift(),e.extcorr.shift(),e.stdevtau.shift(),e.etau.shift(),e.max.shift()):n=e.tau.length>=i?!0:!1;for(var f in t.data.CellData)a.push(t.data.CellData[f].extParam.Tau),o.push(t.data.CellData[f].extParam.Tau0),r.push(t.data.CellData[f].extParam.Tau0cor),l.push(t.data.CellData[f].extParam.taucorr),c.push(t.data.CellData[f].extParam.ext),u.push(t.data.CellData[f].extParam.extCorr),s.push(t.data.CellData[f].extParam.stdevTau),d.push(t.data.CellData[f].extParam.eTau),p.push(t.data.CellData[f].extParam.max);e.avg_rd=[];for(var h=0;h<t.data.CellData[0].Ringdowns[0].length;h++){for(var m=[h],v=0;v<t.data.CellData.length;v++)m.push(t.data.CellData[v].Ringdowns[0][h]);e.avg_rd.push(m)}return e.tau.push(a),e.tau0.push(o),e.tau0corr.push(r),e.taucorr.push(l),e.extcorr.push(u),e.ext.push(c),e.stdevtau.push(s),e.etau.push(d),e.max.push(p),e}angular.module("main").factory("ExCrdSvc",t);var n=!1,i=300;t.$inject=["$rootScope","Data"]}(),function(){angular.module("main").controller("ExCrdCtl",["$scope","cvt","ExCrdSvc",function(t,e,a){e.firstcall=1;var n=function(t,e,a,n,i){this.rate=t,this.DC=e,this.k=a,this.en=n,this.id=i};t.setRate=function(){var t=arguments[0],a=arguments[1];e.crd.setLaserRate(t,a)},t.show_wvfm=!0,t.update_wvfm_state=function(){t.show_wvfm=!t.show_wvfm},t.setEn=function(){var a=arguments[0];t.laser_ctl[a].en=!t.laser_ctl[a].en,e.crd.setEnable([t.laser_ctl[0].en,t.laser_ctl[1].en])},t.laser_ctl=[new n(e.crd.fblue,e.crd.dcblue,e.crd.kblue,e.crd.eblue,"Blue Laser"),new n(e.crd.fred,e.crd.dcred,e.crd.kred,e.crd.ered,"Red Laser")],t.pmt=e.crd.kpmt,t.setGain=function(){e.crd.setGain(t.pmt)},t.setLaserGain=function(){e.crd.setLaserGain([t.laser_ctl[0].k,t.laser_ctl[1].k])},t.purge={pos:!1,flow:.16,setValve:function(){this.pos=!this.pos,e.purge.setSw(this.pos)},setFlow:function(){}},t.data=a,t.setEnable=function(a){t.laser_ctl[a].en=!t.laser_ctl[a].en;var n=t.laser_ctl[a].en;switch(a){case 0:e.crd.eblue=n;break;case 1:e.crd.ered=n}},t.ringdownAvg=[[0,0/0,0/0,0/0,0/0,0/0]],t.options={title:"Ringdown Data",ylabel:"Ringdown Magnitude (au)",labels:["t","Cell 1","Cell 2","Cell 3","Cell 4","Cell 5"],legend:"always"},t.$on("crdDataAvaliable",function(){t.data=a,t.ringdownAvg=a.avg_rd}),t.$on("cvtUpdated",function(){t.laser_ctl[0].rate=e.crd.fblue,t.laser_ctl[0].DC=e.crd.dcblue,t.laser_ctl[0].k=e.crd.kblue,t.laser_ctl[0].enabled=e.crd.eblue,t.laser_ctl[1].rate=e.crd.fred,t.laser_ctl[1].DC=e.crd.dcred,t.laser_ctl[1].k=e.crd.kred,t.laser_ctl[1].enabled=e.crd.ered,t.pmt=e.crd.kpmt})}])}(),function(){function t(){var t=function(t,e,a){function n(){i.data=e[o]}var i=this,o="tau";i.cm=[["<em>&tau;</em>",function(){o="tau",i.options.ylabel="<em>&tau;</em> (&mu;s)"}],["<em>&tau;'</em>",function(){o="taucorr",i.options.ylabel="<em>&tau;'</em> (&mu;s)"}],["<em>&sigma;<sub>&tau;</sub></em>",function(){o="stdevtau",i.options.ylabel="<em>&sigma;<sub>&tau;</sub></em> (us)"}],["Max",function(){o="max",i.options.ylabel="Max (a.u.)"}],null,["Clear Data",function(){e.clear_history()}],["Length",null,[["30",function(){e.set_history(30)}],["60",function(){e.set_history(60)}],["120",function(){e.set_history(120)}],["150",function(){e.set_history(150)}],["300",function(){e.set_history(300)}]]]];var s=a.crd,l=["t"].concat(s.names);i.options={ylabel:"<em>&tau;</em> (&mu;s)",labels:l,legend:"always",axes:{y:{axisLabelWidth:70,drawGrid:s.yGrid},x:{drawAxis:!0,drawGrid:s.xGrid,axisLabelFormatter:function(t){return Dygraph.zeropad(t.getHours())+":"+Dygraph.zeropad(t.getMinutes())+":"+Dygraph.zeropad(t.getSeconds())}}},series:{}};for(var r=s.color.length,c=s.pattern.length,u=s.strokeWidth.length,d=0;d<s.names.length;d++){var p=null===s.pattern[d%c]?null:Dygraph[s.pattern[d%c]];i.options.series[s.names[d]]={color:s.color[d%r],strokeWidth:s.strokeWidth[d%u],strokePattern:p,drawPoints:!0}}void 0!==i.title&&(i.options.title=i.title),i.data=[[0,0/0,0/0,0/0,0/0,0/0]],t.$on("crdDataAvaliable",n)};return t.$inject=["$rootScope","ExCrdSvc","ExReadCfgSvc"],{restrict:"E",require:"contextMenu",scope:{title:"@?"},controller:t,controllerAs:"vm",bindToController:!0,template:'<context-menu menu-options="vm.cm"><dy-graph options="vm.options" data="vm.data" ></dy-graph></context-menu>'}}angular.module("main").directive("exCrdplot",t)}(),function(){function t(t,e,a,n){function i(){t.data=a.data,t.wvfmData=a.wvfm.micf}function o(){t.write_wvfm=e.pas.write_wvfm_state,t.show_wvfm=e.pas.send_wvfm_state}t.data=a.data;var s=n.pas.names.slice();s.unshift("t");var l=n.pas.color.length,r=n.pas.pattern.length;t.show_wvfm=e.pas.send_wvfm,t.update_wvfm_state=function(){t.show_wvfm=!t.show_wvfm,e.pas.send_wvfm(t.show_wvfm)},t.write_wvfm=e.pas.write_wvfm,t.update_wvfm_write_state=function(){t.write_wvfm=!t.write_wvfm,e.pas.write_wvfm(t.write_wvfm)},t.$on("cvtUpdated",o),t.$on("pasDataAvaliable",i),t.wvfmData=[[0,0/0,0/0,0/0,0/0,0/0]],t.options={title:"PAS Waveform Data",ylabel:"Microphone Frequency (a.u.)",labels:["t","Cell 1","Cell 2","Cell 3","Cell 4","Cell 5"],legend:"always",series:{}};for(var c=0;c<n.pas.names.length;c++){var u=null===n.pas.pattern[c%r]?null:Dygraph[n.pas.pattern[c%r]];t.options.series[n.pas.names[c]]={color:n.pas.color[c%l],strokeWidth:1,strokePattern:u,drawPoints:!1}}t.cm_options=[["Mic. Frequency",function(){data_set="micf",t.options.ylabel="Microphone Frequency (a.u.)",t.options.axes.y.valueRange=[null,null]}],["Mic. Time",function(){data_set="mict",t.options.ylabel="Microphone Time (a.u.)",t.options.axes.y.valueRange=[null,null]}],["Photodiode Time",function(){data_set="pd",t.options.ylabel="Photodiode Time (a.u>)",t.options.axes.y.valueRange=[null,null]}]],e.first_call=1}angular.module("main").controller("ExPasCtl",t),t.$inject=["$scope","cvt","ExPasSvc","ExReadCfgSvc"]}(),function(){function t(t,n){function i(){this.f0=[],this.IA=[],this.Q=[],this.p=[],this.abs=[],this.wvfm={micf:[],mict:[],pd:[]},this.drive=!1,this.data=[],this.set_history=function(t){},this.clear=function(){this.f0=[],this.IA=[],this.Q=[],this.p=[],this.abs=[],e=!1}}function o(t,e,a,n,i,o,s){this.IA=t,this.f0=e,this.abs=a,this.Q=n,this.p=i,this.maxi=o,this.maxloc=s}function s(){var i=[n.tObj],s=[n.tObj],r=[n.tObj],c=[n.tObj],u=[n.tObj];e?(l.f0.shift(),l.IA.shift(),l.Q.shift(),l.p.shift(),l.abs.shift()):e=l.f0.length>=a;var d=n.data.PAS.CellData;for(var p in n.data.PAS.CellData)l.data.length-1<p?l.data.push(new o(d[p].derived.IA,d[p].derived.f0,d[p].derived.ext,d[p].derived.noiseLim,d[p].derived.Q,d[p].derived.max[0],d[p].derived.max[1])):l.data[p]={IA:d[p].derived.IA,f0:d[p].derived.f0,abs:d[p].derived.ext,p:d[p].derived.noiseLim,Q:d[p].derived.Q,maxi:d[p].derived.max[0],maxloc:d[p].derived.max[1]},i.push(d[p].derived.f0),s.push(d[p].derived.IA),r.push(d[p].derived.Q),c.push(d[p].derived.noiseLim),u.push(d[p].derived.ext);l.f0.push(i),l.IA.push(s),l.Q.push(r),l.p.push(c),l.abs.push(u),l.drive=n.data.PAS.Drive,l.wvfm.mict=[],l.wvfm.micf=[],l.wvfm.pd=[];for(var f=d[0].MicFreq.dt,h=d[0].MicTime.dt,m=d[0].PhotoDiode.dt,v=0;v<d[0].MicFreq.Y.length;v++){for(var g=[v*f],b=0;b<d.length;b++)g.push(d[b].MicFreq.Y[v]);l.wvfm.micf.push(g)}for(var v=0;v<d[0].MicTime.Y.length;v++){for(var w=[v*h],b=0;b<d.length;b++)w.push(d[b].MicTime.Y[v]);l.wvfm.mict.push(w)}for(var v=0;v<d[0].PhotoDiode.Y.length;v++){for(var y=[v*m],b=0;b<d.length;b++)y.push(d[p].PhotoDiode.Y[v]);l.wvfm.pd.push(y)}t.$broadcast("pasDataAvaliable")}t.$on("dataAvailable",s);var l=new i;return l}angular.module("main").factory("ExPasSvc",t);var e=!1,a=300;t.$inject=["$rootScope","Data"]}(),function(){angular.module("main").controller("ExPasSpkCtl",["$scope","cvt","Data",function(t,e){var a=10,n=5;t.speaker=e.pas.spk;var i={high:3e3,low:500};t.$on("cvtUpdated",function(){t.speaker=e.pas.spk}),t.setPos=function(){t.speaker.pos=!t.speaker.pos,e.pas.spk.updateCtl(t.speaker)},t.updateSpkV=function(){t.speaker.vrange>a?t.speaker.vrange=a:t.speaker.vrange<0&&(t.speaker.vrange=0),t.speaker.voffset>n?t.speaker.voffset=n:t.speaker.voffset<0&&(t.speaker.voffset=0),e.pas.spk.updateCtl(t.speaker)},t.updateSpkF=function(){t.speaker.f0=t.speaker.f0>i.high?i.high:t.speaker.f0,t.speaker.f0=t.speaker.f0<i.low?i.low:t.speaker.f0,e.pas.spk.updateCtl(t.speaker)},t.updateCycle=function(){e.pas.spk.updateCycle(t.speaker.auto,t.speaker.period,t.speaker.length)},t.updateAuto=function(){t.speaker.auto=!t.speaker.auto,t.updateCycle()}}])}(),function(){function t(t,e,a,n,i){this.Vrange=t,this.Voffset=e,this.f0=a,this.modulation=n,this.lasEn=!1}angular.module("main").controller("ExPasLasCtl",["$scope","cvt","Data",function(e,a,n){e.lasCtl=[];for(var i=0;i<a.pas.las.vr.length;i++)e.lasCtl.push(new t(a.pas.las.vr[i],a.pas.las.voffset[i],a.pas.las.f0[i],a.pas.las.modulation[i],a.pas.las.enable[i]));e.$on("dataAvailable",function(){}),e.$on("cvtUpdated",function(){for(var t=0;t<a.pas.las.vr.length;t++)e.lasCtl[t].Vrange=a.pas.las.vr[t],e.lasCtl[t].Voffset=a.pas.las.voffset[t],e.lasCtl[t].f0=a.pas.las.f0[t],e.lasCtl[t].modulation=a.pas.las.modulation[t],e.lasCtl[t].lasEn=a.pas.las.enable[t];console.log(e.lasCtl)}),e.updateMod=function(){var t=arguments[0];e.lasCtl[t].modulation=0===e.lasCtl[t].modulation?1:0;var n=[];for(j=0;j<e.lasCtl.length;j++)n.push(e.lasCtl[j].modulation);a.pas.las.updateMod(n)},e.updateVr=function(){var t=[];for(i=0;i<e.lasCtl.length;i++)t.push(e.lasCtl[i].Vrange);a.pas.las.setVr(t)},e.updateVo=function(){var t=[];for(i=0;i<e.lasCtl.length;i++)t.push(e.lasCtl[i].Voffset);a.pas.las.setVo(t)},e.updatef0=function(){var t=[];for(i=0;i<e.lasCtl.length;i++)t.push(e.lasCtl[i].f0);a.pas.las.setf0(t)},e.updateEnable=function(t){e.lasCtl[t].lasEn=!e.lasCtl[t].lasEn;var n=[];for(t=0;t<e.lasCtl.length;t++)n.push(e.lasCtl[t].lasEn);a.pas.las.updateEnable(n)}}])}(),function(){function t(t){var e=function(e,a){function n(){i.data=a[o]}var i=this,o="IA";i.cm=[["<em>IA (a.u.)</em>",function(){o="IA",i.options.ylabel="IA (a.u.)"}],["<em>f<sub>0</sub></em>",function(){o="f0",i.options.ylabel="<em>f<sub>0</sub></em> (Hz)"}],["Quality",function(){o="Q",i.options.ylabel="Quality (a.u.)"}],["Noise Floor",function(){o="p",i.options.ylabel="Noise (a.u.)"}],["<em>&sigma;<sub>abs</sub></em>",function(){o="abs",i.options.ylabel="<em>&sigma;<sub>abs</sub></em> (Mm<sup>-1</sup>)"}],null,["Clear Data",function(){a.clear()}],["History",null,[["30",function(){a.set_history(30)}],["60",function(){a.set_history(60)}],["120",function(){a.set_history(120)}],["150",function(){a.set_history(150)}],["300",function(){a.set_history(300)}]]],["Grid",null,[["Grid X",function(){}],["Grid Y",function(){}],["Enable",function(){}],["Disable",function(){}]]]];var s=t.pas,l=["t"].concat(s.names);i.options={ylabel:"<em>IA</em> (a.u.)",labels:l,legend:"always",axes:{y:{axisLabelWidth:70,drawGrid:s.yGrid},x:{drawAxis:!0,drawGrid:s.xGrid,axisLabelFormatter:function(t){return Dygraph.zeropad(t.getHours())+":"+Dygraph.zeropad(t.getMinutes())+":"+Dygraph.zeropad(t.getSeconds())}}},series:{}};for(var r=s.color.length,c=s.pattern.length,u=s.strokeWidth.length,d=0;d<s.names.length;d++){var p=null===s.pattern[d%c]?null:Dygraph[s.pattern[d%c]];i.options.series[s.names[d]]={color:s.color[d%r],strokeWidth:s.strokeWidth[d%u],strokePattern:p,drawPoints:!0}}void 0!==i.title&&(i.options.title=i.title),i.data=[[0,0/0,0/0,0/0,0/0,0/0]],e.$on("pasDataAvaliable",n)};return e.$inject=["$rootScope","ExPasSvc"],{restrict:"E",scope:{title:"@?"},controller:e,controllerAs:"vm",bindToController:!0,template:'<context-menu menu-options="vm.cm"><dy-graph options="vm.options" data="vm.data"></dy-graph></context-menu>'}}angular.module("main").directive("exPasplot",t),t.$inject=["ExReadCfgSvc"]}(),function(){function t(t){var e=function(e,a){function n(){i.data=a.wvfm[o]}var i=this,o="micf";i.cm=[["Microphone Frequency Domain",function(){o="micf",i.options.ylabel="Mic Frequency Power (a.u.)",i.options.xlabel="f (Hz)"}],["Microphone Time Domain",function(){o="mict",i.options.ylabel="Mic Time Magnitude (a.u.)",i.options.xlabel="t"}],["Photodiode Time Domain",function(){o="pd",i.options.ylabel="PD Time Magnitude (a.u.)",i.options.xlabel="t"}],null,["Grid",null,[["Grid X",function(){}],["Grid Y",function(){}],["Enable",function(){}],["Disable",function(){}]]]];var s=t.pas,l=["f"].concat(s.names);i.options={ylabel:"Mic Frequency Power (a.u.)",labels:l,legend:"always",axes:{y:{axisLabelWidth:70,drawGrid:s.yGrid},x:{drawAxis:!0,drawGrid:s.xGrid}},series:{}};for(var r=s.color.length,c=s.pattern.length,u=s.strokeWidth.length,d=0;d<s.names.length;d++){var p=null===s.pattern[d%c]?null:Dygraph[s.pattern[d%c]];i.options.series[s.names[d]]={color:s.color[d%r],strokeWidth:s.strokeWidth[d%u],strokePattern:p,drawPoints:!0}}void 0!==i.title&&(i.options.title=i.title),i.data=[[0,0/0,0/0,0/0,0/0,0/0]],i.options.xlabel="f (Hz)",e.$on("pasDataAvaliable",n)};return e.$inject=["$rootScope","ExPasSvc"],{restrict:"E",scope:{title:"@?"},controller:e,controllerAs:"vm",bindToController:!0,template:'<context-menu menu-options="vm.cm"><dy-graph options="vm.options" data="vm.data"></dy-graph></context-menu>'}}angular.module("main").directive("exPasWvfm",t),t.$inject=["ExReadCfgSvc"]}(),function(){function t(t,e,a){t.DeviceData=a.data,t.Device=a,t.updateSP=function(){var t=arguments[0],a=arguments[1];e.flows.updateSP(a,t.Qsp)},t.$on("dataAvailable",function(){t.DeviceData=a.data,t.Device=a})}angular.module("main").controller("ExFlowCtl",t),t.$inject=["$scope","cvt","ExFlowSvc"]}(),function(){function t(){var t=function(t,e,a){function n(){var t=["t"];for(var a in e.data)t.push(e.data[a].label);if(t!==i.options.labels){i.ref.updateOptions({labels:t.slice()});for(var n=i.options.labels.slice(1),l=s.color.length,r=s.pattern.length,c=s.strokeWidth.length,u=0;u<n.length;u++){var d=null===s.pattern[u%r]?null:Dygraph[s.pattern[u%r]];i.options.series[n[u]]={color:s.color[u%l],strokeWidth:s.strokeWidth[u%c],strokePattern:d,drawPoints:!0}}}i.data=e[o]}var i=this,o="P";i.ref={},i.cm=[["P",function(){o="P",i.options.ylabel="<em>P</em> (mb)",i.options.axes.y.valueRange=[null,null]}],["T",function(){o="T",i.options.ylabel="<em>T</em> (&deg;C)",i.options.axes.y.valueRange=[null,null]}],["Q",function(){o="Q",i.options.ylabel="<em>Q</em> (lpm)",i.options.axes.y.valueRange=[null,null]}],["Q0",function(){o="Q0",i.options.ylabel="<em>Q<sub>0</sub></em> (slpm)",i.options.axes.y.valueRange=[null,null]}],null,["Controller",null,[["Enable All",function(){console.log("Enabling all.")}],["Clear Data",function(){e.clear_data()}]]],["Autoscale",null,[["Autoscale 1x",function(){i.options.axes.y.valueRange=i.ref.yAxisRange()}],["Autoscale",function(){i.options.axes.y.valueRange=[null,null]}]]]];var s=a.flow;i.options={ylabel:"<em>P</em> (mb)",labels:["t","Alicat0"],legend:"always",axes:{y:{axisLabelWidth:70,drawGrid:s.yGrid},x:{drawAxis:!0,drawGrid:s.xGrid,axisLabelFormatter:function(t){return Dygraph.zeropad(t.getHours())+":"+Dygraph.zeropad(t.getMinutes())+":"+Dygraph.zeropad(t.getSeconds())}}},series:{},labelsUTC:!0},void 0!==i.title&&(i.options.title=i.title),i.data=[[0,0/0]],t.$on("FlowDataAvailable",n)};return t.$inject=["$rootScope","ExFlowSvc","ExReadCfgSvc"],{restrict:"E",require:"contextMenu",scope:{title:"@?"},controller:t,controllerAs:"vm",bindToController:!0,template:'<context-menu menu-options ="vm.cm"><dy-graph options="vm.options" ref="vm.ref" data="vm.data" ></dy-graph></context-menu>'}}angular.module("main").directive("exFlowplot",t)}(),function(){function t(t,e,a){function n(){this.IDs=[],this.T=[],this.P=[],this.data={},this.clear_data=function(){this.P=[],this.T=[],c=!1,r=0},this.set_max=function(t){l=t}}function i(t,e){this.T=e,this.P=t}function o(){for(var a="",n=0;n<d.length;n++)a=d[n].id,a in e.data&&(a in u.data?(u.data[a].P=e.data[a].P,
u.data[a].T=e.data[a].T):(u.data[a]=new i(e.data[a].P,e.data[a].T),0===u.IDs.length?u.IDs=[a]:u.IDs.push(a)));d.forEach(s),c?(u.P.shift(),u.T.shift()):r+=1,u.P.push(p),u.T.push(f),c=r>=l,t.$broadcast("PptDataAvailable")}function s(t,a){a?(p.push(u.data[t.id].P),f.push(u.data[t.id].T)):(p=[e.tObj,u.data[t.id].P],f=[e.tObj,u.data[t.id].T])}var l=300,r=0,c=!1,u=new n,d=a.ppt;t.$on("deviceListRefresh",function(){d=a.ppt}),t.$on("dataAvailable",o);var p,f;return u}angular.module("main").factory("ExPptSvc",t),t.$inject=["$rootScope","Data","cvt"]}(),function(){angular.module("main").controller("ExHumidityCtl",["$scope","cvt","Data",function(t,e,a){e.first_call=1,t.h=e.humidifier,t.setEnable=function(e){t.h[e].en=!t.h[e].en,t.updateHum(e)},t.$on("cvtUpdated",function(){t.h=e.humidifier}),t.updateHum=function(){var t=arguments[0];e.humidifier[t].updateParams()},t.ctlrOutData=[[0,0/0,0/0]],t.RH=[[0,0/0,0/0]],t.optCtlOut={ylabel:"Controller Output",labels:["t","med","high"],legend:"always"},t.optRH={ylabel:"RH (%)",labels:["t","med","high"],legend:"always"}}])}(),function(){angular.module("main").controller("ExCalibrationCtl",["$scope","ExCalibrationSvc",function(t,e){t.data=[],t.save=function(){e.ship_data(t.data)},t.base_vals=[{id:"Wait",step:"Wait",descr:"Set a wait time in the ozone cal in seconds"},{id:"Filter",step:"Filter",descr:"Boolean that sets the filter state."},{id:"Cabin",step:"Cabin",descr:"Boolean that sets the cabin valve state."},{id:"Denuder",step:"Denuder/Bypass",descr:"Boolean that sets the denuder/bypass valve state."},{id:"Speaker",step:"Speaker",descr:"Boolean that sets the speaker state."}],t.ozone_vals=[{id:"O2-Valve",step:"O2 Valve",descr:"Boolean that sets the O2 valve position."},{id:"O3-Valve",step:"O3 Valve",descr:"Boolean that sets the O3 valve state."},{id:"O3-Generator-Power",step:"O3 Generator",descr:"Boolean that sets the O3 generator state."},{id:"O2-Flow-Rate",step:"QO2",descr:"Numeric to set the oxygen flow rate"},{id:"O3-Level",step:"O3 Level",descr:"Numeric to set the oxygen flow rate"},{id:"O3-Dump-Rate",step:"QO3,dump",descr:"Ozone dump rate in lpm."}],t.table_vals=t.base_vals.slice();for(var a=0;a<t.ozone_vals.length;a++)t.table_vals.push(t.ozone_vals[a]);var n="",i="";t.clickRow=function(e){switch(i=e.id.toString()){case"Wait":case"Speaker":n="20";break;case"O2-Flow-Rate":case"O3-Dump-Rate":n="100";break;case"O3-Level":n="1";break;default:n="FALSE"}t.data.push({id:i,val:n})}}])}(),function(){angular.module("main").factory("ExCalibrationSvc",["$http","net",function(t,e){var a={},n=function(t){var e='<?xml version="1.0" encoding="utf-8"?>\r\n<OZONE>\r\n';return t.forEach(function(t){e+="	<"+t.id+">"+t.val+"</"+t.id+">\r\n"}),e+="</OZONE>",console.log(e),e};return a.ship_data=function(a){t({method:"POST",url:e.address()+"Calibration/saveCalFile?file_name=test_cal.xml",data:n(a),headers:{"Content-Type":"application/x-www-form-urlencoded"}})},a}])}(),function(){function t(){return{restrict:"E",scope:{},templateUrl:"html/side.html"}}angular.module("main").directive("sidebar",t)}(),function(){angular.module("main").factory("navservice",["$http","net","cvt",function(t,e){var a={};return a.stop=function(){t.get(e.address()+"General/Stop")},a.save=function(a){var n=a?1:0;t.get(e.address()+"General/Save?save="+n.toString())},a}])}(),function(){function t(){return{restrict:"E",scope:{name:"=?"},templateUrl:"html/navi.html"}}angular.module("main").directive("navi",t)}(),function(){angular.module("main").controller("navctlr",["$scope","navservice",function(t,e){t.save=!0,t.updateSave=function(){t.save=!t.save,e.save(t.save)},t.stop=function(){e.stop()}}])}(),function(){function t(t,e){t.ListObj=e,t.setChecked=function(){e.update(t.ListObj)},t.$on("CheckListUpdated",function(){t.ListObj=e})}angular.module("main").controller("ExChecklistCtl",t),t.$inject=["$scope","ExChecklistSvc"]}(),function(){function t(t,e,a){var n={main:[{}],update:function(t){this.main=t.main}},i=e.$$absUrl,o=i.search("#/");i=i.slice(0,o);var s="/"===i.slice(-1)?"":"/",l=i+s+"checklist.json";return n.load=function(){t.get(l).then(function(t){n.main=t.data.main;for(var e in n.main){n.main[e].checked=[];for(var i in n.main[e].items)n.main[e].checked.push(!1)}a.$broadcast("CheckListUpdated")},function(){console.log("Checklist not found...")})["finally"](function(){})},n}angular.module("main").factory("ExChecklistSvc",t),t.$inject=["$http","$location","$rootScope"]}(),function(){function t(t,e,a){function n(){this.IDs=[],this.RH=[],this.T=[],this.Td=[],this.data={},this.clear_data=function(){this.RH=[],this.Td=[],this.T=[],p=!1,f=0}}function i(){this.RH=0,this.Td=0,this.T=0,this.label=""}function o(t,a){var n=t.id;a?(l.push(u.data[n].RH),r.push(u.data[n].T),c.push(u.data[n].Td)):(l=[e.tObj,u.data[n].RH],r=[e.tObj,u.data[n].T],c=[e.tObj,u.data[n].Td])}function s(){for(var a="",n=0;n<h.length;n++)h[n].id in e.data&&(a=h[n].id,a in u.data||(u.data[a]=new i,0===u.IDs.length?u.IDs=[a]:u.IDs.push(a)),u.data[a].RH=e.data[a].RH,u.data[a].T=e.data[a].T,u.data[a].Td=e.data[a].Td,u.data[a].label=h[n].label);h.forEach(o),p?(u.RH.shift(),u.T.shift(),u.Td.shift()):f+=1,u.RH.push(l),u.T.push(r),u.Td.push(c),p=f>=d,t.$broadcast("VaisalaDataAvailable")}var l,r,c,u=new n,d=300,p=!1,f=0,h=a.vaisala;return t.$on("dataAvailable",s),t.$on("deviceListRefresh",function(){h=a.vaisala}),u}angular.module("main").factory("ExVaisalaSvc",t),t.$inject=["$rootScope","Data","cvt"]}(),function(){function t(t,e,a){t.Devices={},t.updateSP=function(){var t=arguments[0];e.flows.updateSP(t.ID,t.sp)},t.$on("VaisalaDataAvailable",function(){t.Devices=a.data})}angular.module("main").controller("ExVaisalaCtl",t),t.$inject=["$scope","cvt","ExVaisalaSvc"]}(),function(){function t(){function t(t,e,a){function n(){var t=["t"];for(var a in e.data)t.push(e.data[a].label);if(t!==i.options.labels){i.ref.updateOptions({labels:t.slice()});for(var n=i.options.labels.slice(1),l=s.color.length,r=s.pattern.length,c=s.strokeWidth.length,u=0;u<n.length;u++){var d=null===s.pattern[u%r]?null:Dygraph[s.pattern[u%r]];i.options.series[n[u]]={color:s.color[u%l],strokeWidth:s.strokeWidth[u%c],strokePattern:d,drawPoints:!0}}}i.data=e[o]}var i=this,o="RH";i.ref={},i.cm=[["RH",function(){o="RH",i.options.ylabel="<em>RH</em> (%)",i.options.axes.y.valueRange=[null,null]}],["T",function(){o="T",i.options.ylabel="<em>T</em> (&deg;C)",i.options.axes.y.valueRange=[null,null]}],["T<sub>d</sub>",function(){o="Td",i.options.ylabel="<em>T<sub>d</sub></em> (&deg;C)",i.options.axes.y.valueRange=[null,null]}],null,["Meter",null,[["Enable All",function(){console.log("Enabling all.")}],["Clear Data",function(){e.clear_data()}]]],["Autoscale",null,[["Autoscale 1x",function(){i.options.axes.y.valueRange=i.ref.yAxisRange()}],["Autoscale",function(){i.options.axes.y.valueRange=[null,null]}]]]];var s=a.vaisala;i.options={ylabel:"<em>RH</em> (%)",labels:["t","Vaisala0"],legend:"always",axes:{y:{axisLabelWidth:70,drawGrid:s.yGrid},x:{drawAxis:!0,drawGrid:s.xGrid,axisLabelFormatter:function(t){return Dygraph.zeropad(t.getHours())+":"+Dygraph.zeropad(t.getMinutes())+":"+Dygraph.zeropad(t.getSeconds())}}},series:{},labelsUTC:!0},void 0!==i.title&&(i.options.title=i.title),i.data=[[0,0/0]],t.$on("VaisalaDataAvailable",n)}return t.$inject=["$rootScope","ExVaisalaSvc","ExReadCfgSvc"],{restrict:"E",require:"contextMenu",scope:{title:"@?"},controller:t,controllerAs:"vm",bindToController:!0,template:'<context-menu menu-options ="vm.cm"><dy-graph options="vm.options" ref="vm.ref" data="vm.data" ></dy-graph></context-menu>'}}angular.module("main").directive("exVaisalaPlot",t)}(),function(){function t(t,e,a){function n(){console.log("Update TE Tech CVT.")}t.ctl={P:1,I:.75,D:0},t.Tsp=18,t.ch_mult={htx:0,clx:1},t.$on("tetechCVTUpdated",n),t.set_pid=function(){console.log("New PID control set.")},t.set_mult=function(){a.tec.updateMult([t.ch_mult.htx,t.ch_mult.clx]),console.log("Set multipliers.")},t.update_sp=function(){a.tec.updateSP(t.Tsp)},a.first_call=1}angular.module("main").controller("ExTetechCtl",t),t.$inject=["$scope","ExTetechSvc","cvt"]}(),function(){function t(t,e,a){function n(){this.t1=[],this.t2=[],this.pow=[],this.data={t1:0,t2:0,power:0},this.cvt={},this.label="",this.clear_data=function(){this.t1=[],this.t2=[],this.pow=[],r=0,l=!1}}function i(){var a=e.data.tetech;o.data.t1=a.Input1,o.data.t2=a.Input2,o.data.pow=a.Power,o.label=o.cvt.label,l?(o.t1.shift(),o.t2.shift(),o.pow.shift()):0===r?(o.t1=[[e.tObj,o.data.t1]],o.t2=[[e.tObj,o.data.t2]],o.pow=[[e.tObj,o.data.pow]],r+=1):r+=1,o.t1.push([e.tObj,o.data.t1]),o.t2.push([e.tObj,o.data.t2]),o.pow.push([e.tObj,o.data.pow]),l=r>=s,t.$broadcast("TeTechDataAvailable")}var o=new n,s=300,l=!1,r=0;return o.cvt=a.tec,t.$on("dataAvailable",i),t.$on("deviceListRefresh",function(){o.cvt=a.tec,t.$broadcast("tetechCVTUpdated")}),o}angular.module("main").factory("ExTetechSvc",t),t.$inject=["$rootScope","Data","cvt"]}(),function(){function t(){function t(t,e,a){function n(){if(l="pow"==o?["t","Power"]:["t","T"],l!==i.options.labels){i.ref.updateOptions({labels:l.slice()});for(var t=i.options.labels.slice(1),a=s.color.length,n=s.pattern.length,r=s.strokeWidth.length,c=0;c<t.length;c++){var u=null===s.pattern[c%n]?null:Dygraph[s.pattern[c%n]];i.options.series[t[c]]={color:s.color[c%a],strokeWidth:s.strokeWidth[c%r],strokePattern:u,drawPoints:!0}}}i.data=e[o]}var i=this,o="t1";i.ref={},i.cm=[["T<sub>1</sub>",function(){o="t1",i.options.ylabel="<em>T<sub>1</sub></em> (&deg;C)",i.options.axes.y.valueRange=[null,null]}],["T<sub>2</sub>",function(){o="t2",i.options.ylabel="<em>T<sub>2</sub></em> (&deg;C)",i.options.axes.y.valueRange=[null,null]}],["Power",function(){o="pow",i.options.ylabel="<em>Power</em> (%)",i.options.axes.y.valueRange=[null,null]}],null,["Clear Data",function(){e.clear_data()}],["Autoscale",null,[["Autoscale 1x",function(){i.options.axes.y.valueRange=i.ref.yAxisRange()}],["Autoscale",function(){i.options.axes.y.valueRange=[null,null]}]]]];var s=a.tec;i.options={ylabel:"<em>T<sub>1</sub></em> (&deg;C)",labels:["t","T"],legend:"never",axes:{y:{axisLabelWidth:70,drawGrid:s.yGrid},x:{drawAxis:!0,drawGrid:s.xGrid,axisLabelFormatter:function(t){return Dygraph.zeropad(t.getHours())+":"+Dygraph.zeropad(t.getMinutes())+":"+Dygraph.zeropad(t.getSeconds())}}},series:{},labelsUTC:!0},void 0!==i.title&&(i.options.title=i.title),i.data=[[0,0/0]],t.$on("TeTechDataAvailable",n)}return t.$inject=["$rootScope","ExTetechSvc","ExReadCfgSvc"],{restrict:"E",require:"contextMenu",scope:{title:"@?"},controller:t,controllerAs:"vm",bindToController:!0,template:'<context-menu menu-options ="vm.cm"><dy-graph options="vm.options" ref="vm.ref" data="vm.data" ></dy-graph></context-menu>'}}angular.module("main").directive("exTetechPlot",t)}(),function(){function t(){function t(t,e,a){function n(){var t=["t"].concat(e.IDs);t!==i.options.labels&&i.ref.updateOptions({labels:t.slice()}),i.data=e[o]}var i=this,o="P";i.ref={},i.cm=[["P",function(){o="P",i.options.ylabel="<em>P</em> (mb)",i.options.axes.y.valueRange=[null,null]}],["T",function(){o="T",i.options.ylabel="<em>T</em> (&deg;C)",i.options.axes.y.valueRange=[null,null]}],null,["Controller",null,[["Enable All",function(){console.log("Enabling all.")}],["Clear Data",function(){e.clear_data()}]]],["Autoscale",null,[["Autoscale 1x",function(){i.options.axes.y.valueRange=i.ref.yAxisRange()}],["Autoscale",function(){i.options.axes.y.valueRange=[null,null]}]]]];var s=a.ppt;i.options={ylabel:"P (mb)",labels:["t","PPT0"],legend:"always",axes:{y:{axisLabelWidth:70,drawGrid:s.yGrid},x:{drawAxis:!0,drawGrid:s.xGrid,axisLabelFormatter:function(t){return Dygraph.zeropad(t.getHours())+":"+Dygraph.zeropad(t.getMinutes())+":"+Dygraph.zeropad(t.getSeconds())}}},labelsUTC:!0},void 0!==i.title&&(i.options.title=i.title),i.data=[[0,0/0]],t.$on("PptDataAvailable",n)}return t.$inject=["$rootScope","ExPptSvc","ExReadCfgSvc"],{restrict:"E",require:"contextMenu",scope:{title:"@?"},controller:t,controllerAs:"vm",bindToController:!0,template:'<context-menu menu-options ="vm.cm"><dy-graph options="vm.options" ref= "vm.ref" data="vm.data" ></dy-graph></context-menu>'}}angular.module("main").directive("exPptPlot",t)}(),function(){function t(t,e,a){function n(){this.IDs=[],this.Tsink=[],this.Tobj=[],this.Vout=[],this.data={},this.clear_data=function(){this.Tsink=[],this.Tobj=[],this.Vout=[],p=!1,f=0}}function i(){this.Vout=0,this.Tobj=0,this.Tsink=0,this.label=""}function o(t,a){var n=t.id;a?(l.push(u.data[n].Vout),r.push(u.data[n].Tobj),c.push(u.data[n].Tsink)):(l=[e.tObj,u.data[n].Vout],r=[e.tObj,u.data[n].Tobj],c=[e.tObj,u.data[n].Tsink])}function s(){for(var a="",n=0;n<h.length;n++)h[n].id in e.data&&(a=h[n].id,a in u.data||(u.data[a]=new i,0===u.IDs.length?u.IDs=[a]:u.IDs.push(a)),u.data[a].Vout=e.data[a].Vout,u.data[a].Tsink=e.data[a].Tsink,u.data[a].Tobj=e.data[a].Tobj,u.data[a].label=h[n].label);h.forEach(o),p?(u.Vout.shift(),u.Tsink.shift(),u.Tobj.shift()):f+=1,u.Vout.push(P),u.Tsink.push(T),u.Tobj.push(Q),p=f>=d,t.$broadcast("MTecDataAvailable")}var l,r,c,u=new n,d=300,p=!1,f=0,h=a.mTEC;return t.$on("dataAvailable",s),t.$on("deviceListRefresh",function(){h=a.mTEC}),u}angular.module("main").factory("ExMeerstetterSvc",t),t.$inject=["$rootScope","Data","cvt"]}();