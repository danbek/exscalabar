<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">

		<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
		Remove this if you use the .htaccess -->
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<script type="text/javascript" src="../js/populate.js"></script>

		<title>EXSCALABAR</title>
		<meta name="description" content="">
		<meta name="author" content="Matt">

		<link rel="stylesheet" href="../assets/bootstrap-3.2.0-dist/css/bootstrap.css" type="text/css" media="screen" title="no title" charset="utf-8"/>
		<link rel="stylesheet" href="../assets/sticky-footer.css" type="text/css" media="screen" title="no title" charset="utf-8"/>

		<script src="../assets/d3/d3.min.js"></script>
		<script src="../assets/nvd3/nv.d3.min.js"></script>

		<link href="../assets/nvd3/nv.d3.min.css" rel="stylesheet" type="text/css">
		<meta name="viewport" content="width=device-width; initial-scale=1.0">

		<!-- Replace favicon.ico & apple-touch-icon.png in the root of your domain and delete these references -->
		<link rel="shortcut icon" href="/favicon.ico">
		<link rel="apple-touch-icon" href="/apple-touch-icon.png">

		<style>
			.ctl-label {
				display: inline-block;
				width: 75px;
				/*margin-left: 15px;*/
				margin: 2px;
			}
			.ctl-input {
				width: 55px;
				margin: 2px;
			}

			.msg-footer {
				width: auto;
			}

			#chart svg {
				height: 350px;
			}

		</style>
	</head>

	<body onload = "pop_nav()">
		<div id = "xnav"></div>

		<div class="container-fluid">
			<div class="page-header">
				<h1>CRDS Control</h1>
			</div>
			<div class="row">
				<div class="col-lg-2 col-md-3 col-sm-3" role="main">
					<div class="row">
						<div class="panel panel-default">
							<div class="panel-heading">
								Laser Control
							</div>
							<div class="row">
								<div class="col-md-5">
									<div class="form-group" id="fcrd">
										<label class = "ctl-label" for="bluerate">f<sub>blue</sub> (Hz)</label>
										<input type="number" id="bluerate" class="form-control" placeholder="2000" data-toggle="tooltip" data-placement="right" title="Blue laser repetition rate (in Hz)."/>
										<br />
										<label class = "ctl-label" for="redrate">f<sub>red</sub> (Hz)</label>
										<input type="number" id="redrate" class="form-control" placeholder="1000"/>
									</div>
								</div>
								<div class="col-md-5">
									<div class="form-group" id ="dccrd">
										<label class = "ctl-label" for="bluedc">DC<sub>blue</sub> (Hz)</label>
										<input type="number" id="bluedc" class="form-control" placeholder="50"/>
										<br />
										<label class = "ctl-label" for="reddc">DC<sub>red</sub> (Hz)</label>
										<input type="number" id="reddc" class="form-control" placeholder="50"/>
									</div>
								</div>
								<div class="col-md-5">
									<div class="form-group">
										<button type="button" class="btn btn-primary" id ="benable">
											Blue Enabled
										</button>
									</div>
								</div>
								<div class="col-md-5">
									<div class="form-group">
										<button type="button" class="btn btn-primary" id ="renable">
											Red Enabled
										</button>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="panel panel-default" data-toggle="tooltip" data-placement="right"  title="PMT gains in volts.">
							<div class="panel-heading">
								Laser Gain
							</div>
							<div class="row">
								<div class="col-md-5">
									<label class = "ctl-label" for="g1">Gain 1</label>
									<input type="number" id="g1" class="form-control" placeholder="5" />
									<br />
									<label class = "ctl-label" for="g2">Gain 2</label>
									<input type="number" id="g2" class="form-control" placeholder="5" />
									<br />
									<label class = "ctl-label" for="g3">Gain 3</label>
									<input type="number" id="g3" class="form-control" placeholder="5" />
									<br />
									<label class = "ctl-label" for="g4">Gain 4</label>
									<input type="number" id="g4" class="form-control" placeholder="5" />
									<br />
									<label class = "ctl-label" for="g5">Gain 5</label>
									<input type="number" id="g5" class="form-control" placeholder="5" />
									<br />
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-lg-8 col-md-7 col-sm-6">
					<div id="chart" class='with-3d-shadow with-transitions'>
						<svg></svg>
					</div>
					<div class="dropdown">
						<button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
							Dropdown
							<span class="caret"></span>
						</button>
						<ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
							<li role="presentation">
								<a role="menuitem" tabindex="-1" id="tau">Tau</a>
							</li>
							<li role="presentation">
								<a role="menuitem" tabindex="-1" id="tau0">Tau0</a>
							</li>
							<li role="presentation">
								<a role="menuitem" tabindex="-1" id="ext">Extinction</a>
							</li>
							<li role="presentation">
								<a role="menuitem" tabindex="-1" id="max">Max</a>
							</li>
							<li role="presentation">
								<a role="menuitem" tabindex="-1" href="#">Separated link</a>
							</li>
						</ul>
					</div>
				</div>
				<div class="col-lg-2 col-md-2 col-sm-3" role="complementary" id ="snav"></div>
			</div>
		</div>

		<footer class="footer">
			<form class="form-inline" style:"width:100%;">
				<div class="form-group" class="msg-footer" style:"width:100%;">
					<label for="msg-out">System Message</label>
					<div class="input-group input-group-lg">
						<input class="form-control" type="text" id="msg-out" placeholder="This is a system message." disabled />
						<div class="input-group-btn">
							<button class="btn">
								Clear
							</button>
						</div>
					</div>
				</div>
			</form>
		</footer>
		<script src="../assets/jquery-2.1.1.js" type="text/javascript" charset="utf-8"></script>
		<script src="../assets/bootstrap-3.2.0-dist/js/bootstrap.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript" src="../js/general.js"></script>
		<script src="../js/crd.js" type="text/javascript" charset="UTF-8"></script>
		<script type="text/javascript">
			var chart;
			nv.addGraph(function() {
				chart = nv.models.lineWithFocusChart();

				chart.xAxis.tickFormat(function(d) {
					return d3.time.format('%X')(new Date(d))
				});
				chart.x2Axis.tickFormat(function(d) {
					return d3.time.format('%X')(new Date(d))
				});
				chart.yAxis.tickFormat(d3.format(',.2f'));
				chart.y2Axis.tickFormat(d3.format(',.2f'));

				d3.select('#chart svg').datum(testData()).call(chart);

				nv.utils.windowResize(chart.update);

				return chart;
			});
			var d = new Date();
			var data = [{
				x : d.getTime(),
				y : 0
			}];
			var data2 = [{
				x : d.getTime(),
				y : 0
			}];
			var data3 = [{
				x : d.getTime(),
				y : 0
			}];
			var data4 = [{
				x : d.getTime(),
				y : 0
			}];
			var data5 = [{
				x : d.getTime(),
				y : 0
			}];

			function testData() {
				return [{
					values : data,
					key : "Matt's Data"
				}, {
					values : data2,
					key : "Dan's Data"
				}, {
					values : data3,
					key : "Terzah's Data"
				}, {
					values : data4,
					key : "Sasha's Data"
				}, {
					values : data5,
					key : "Noah's Data"
				}];
			}

			setInterval(function() {
				if (data.length >= 20) {
					data.pop();
					data2.pop();
					data3.pop();
					data4.pop();
					data5.pop();
				}
				d = new Date();

				data.unshift({
					x : d.getTime(),
					y : data[data.length - 1].y + 4 * Math.random() - 2.0
				});

				data2.unshift({
					x : d.getTime(),
					y : data[data.length - 1].y + 4 * Math.random() - 2.0
				});
				data3.unshift({
					x : d.getTime(),
					y : data[data.length - 1].y + 4 * Math.random() - 2.0
				});
				data4.unshift({
					x : d.getTime(),
					y : data[data.length - 1].y + 4 * Math.random() - 2.0
				});
				data5.unshift({
					x : d.getTime(),
					y : data[data.length - 1].y + 4 * Math.random() - 2.0
				});

				// Update the chart so that if the currently viewed window ends at
				// the most recent data point, the window of viewed data 'slides' so
				// the most recent data points are always shown.
				currentExtent = chart.brushExtent();
				dataEnd = data[0].x;
				prevDataEnd = data[1].x;
				if (currentExtent && (currentExtent[1] == prevDataEnd)) {
					delta = dataEnd - prevDataEnd;
					newStart = currentExtent[0] + delta;
					newEnd = dataEnd;
					chart.brushExtent([newStart, newEnd]).update();
				} else {
					chart.update();
				}
			}, 1000);

		</script>
	</body>
</html>
