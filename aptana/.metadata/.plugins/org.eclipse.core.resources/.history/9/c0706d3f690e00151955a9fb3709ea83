(function() {
	angular.module('main')
	.controller('pPlot', ['$scope', function($scope) {

		$scope.options = {
			chart : {
				type : 'lineChart',
				height : 180,
				margin : {
					top : 10,
					right : 10,
					bottom : 10,
					left : 10
				},
				x : function(d) {
					return d.x;
				},
				y : function(d) {
					return d.y;
				},
				useInteractiveGuideline : true,
				transitionDuration : 500,
				yAxis : {
					tickFormat : function(d) {
						return d3.format('.01f')(d);
					}
				}
			}
		};
		$scope.options1 = angular.copy($scope.options);
		$scope.options1.chart.transitionDuration = 1;
		$scope.options1.chart.yDomain = [-1, 1];

		$scope.data = [{
			values : [],
			key : 'Random Walk'
		}];

		$scope.run = true;

		var x = 0;
		setInterval(function() {
			if (!$scope.run)
				return;
			$scope.data[0].values.push({
				x : x,
				y : Math.random() - 0.5
			});
			if ($scope.data[0].values.length > 20)
				$scope.data[0].values.shift();
			x++;
			$scope.$apply();
		}, 500);

	}]);
})();
